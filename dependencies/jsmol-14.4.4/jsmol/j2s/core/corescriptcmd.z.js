(function(Y,Z,$,aa,ba,N,I,O,Q,R,K,S,T,ca,M,E,U,L,V,da,W,ea,fa,ga,ha,ia,ja,ka,la,z,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,l,X){N("JS");c$=R(function(){this.e=this.vwr=null;this.chk=!1;this.st=null;this.slen=0;Q(this,arguments)},JS,"ScriptExt");l(c$,"init",function(a){this.e=a;this.vwr=this.e.vwr;return this},"~O");l(c$,"atomExpressionAt",function(a){return this.e.atomExpressionAt(a)},"~N");l(c$,"checkLength",function(a){this.e.checkLength(a)},"~N");l(c$,"error",
function(a){this.e.error(a)},"~N");l(c$,"invArg",function(){this.e.invArg()});l(c$,"invPO",function(){this.error(23)});l(c$,"getShapeProperty",function(a,c){return this.e.getShapeProperty(a,c)},"~N,~S");l(c$,"paramAsStr",function(a){return this.e.paramAsStr(a)},"~N");l(c$,"centerParameter",function(a){return this.e.centerParameter(a,null)},"~N");l(c$,"floatParameter",function(a){return this.e.floatParameter(a)},"~N");l(c$,"getPoint3f",function(a,c){return this.e.getPoint3f(a,c)},"~N,~B");l(c$,"intParameter",
function(a){return this.e.intParameter(a)},"~N");l(c$,"isFloatParameter",function(a){switch(this.e.tokAt(a)){case 2:case 3:return!0}return!1},"~N");l(c$,"setShapeProperty",function(a,c,b){this.e.setShapeProperty(a,c,b)},"~N,~S,~O");l(c$,"showString",function(a){this.e.showString(a)},"~S");l(c$,"stringParameter",function(a){return this.e.stringParameter(a)},"~N");l(c$,"getToken",function(a){return this.e.getToken(a)},"~N");l(c$,"tokAt",function(a){return this.e.tokAt(a)},"~N");l(c$,"setShapeId",function(a,
c,b){b&&this.invArg();c=this.e.setShapeNameParameter(c).toLowerCase();this.setShapeProperty(a,"thisID",c);return c},"~N,~N,~B");l(c$,"getColorTrans",function(a,c,b,e){b=3.4028235E38;1765808134!=a.theTok&&--c;switch(this.tokAt(c+1)){case 603979967:c++;b=this.isFloatParameter(c+1)?a.getTranslucentLevel(++c):this.vwr.getFloat(570425354);break;case 1073742074:c++,b=0}a.isColorParam(c+1)?e[0]=a.getArgbParam(++c):1073742333==this.tokAt(c+1)?(e[0]=0,a.iToken=c+1):3.4028235E38==b?this.invArg():e[0]=-2147483648;
return b},"JS.ScriptEval,~N,~B,~A");l(c$,"finalizeObject",function(a,c,b,e,f,d,g,h){f&&this.setShapeProperty(a,"set",d);-2147483648!=c&&this.e.setShapePropertyBs(a,"color",Integer.$valueOf(c),h);3.4028235E38!=b&&this.e.setShapeTranslucency(a,"","translucent",b,h);0!=e&&this.setShapeProperty(a,"scale",Integer.$valueOf(e));0<g&&(this.e.setMeshDisplayProperty(a,g,0)||this.invArg())},"~N,~N,~N,~N,~B,~O,~N,JU.BS");N("JS");O(["JS.ScriptExt"],"JS.CmdExt","java.lang.Boolean $.Float $.Long java.util.Hashtable $.Map JU.AU $.BS $.Base64 $.Lst $.M3 $.M4 $.Measure $.P3 $.P4 $.PT $.Quat $.SB $.V3 J.api.Interface J.atomdata.RadiusData J.c.STER $.VDW J.i18n.GT JM.Atom $.AtomCollection $.BondSet $.LabelToken JS.SV $.ScriptCompiler $.ScriptError $.ScriptEval $.ScriptInterruption $.ScriptMathProcessor $.ScriptParam $.T JU.BSUtil $.BoxInfo $.C $.Edge $.Elements $.Escape $.Logger $.Parser $.Point3fi $.SimpleUnitCell JV.FileManager $.JC $.StateManager $.Viewer".split(" "),
function(){c$=V(JS,"CmdExt",JS.ScriptExt);T(c$,function(){W(this,JS.CmdExt,[])});X(c$,"dispatch",function(a,c,b){this.chk=this.e.chk;this.slen=this.e.slen;this.st=b;switch(a){case 1073741866:b[0].value=this.prepareBinaryOutput(b[0]);break;case 4098:this.assign();break;case 134221829:this.cache();break;case 4102:this.calculate();break;case 4103:this.capture();break;case 4105:this.centerAt();break;case 134221831:this.compare();break;case 528395:this.console();break;case 4106:this.connect(1);break;case 1094717448:this.configuration();
break;case 134221834:this.data();break;case 1613238294:this.connect(0);break;case 4120:this.image();break;case 4124:this.macro();break;case 4125:this.mapProperty();break;case 4126:this.minimize();break;case 1275072532:this.modulation();break;case 4130:this.mutate();break;case 4131:this.navigate();break;case 4133:case 134221850:case 4138:this.plot(b);break;case 134222350:this.show();break;case 528443:this.stereo();break;case 1814695966:this.unitcell(c?2:1);break;case 134221856:return this.write(c?
b:null);case 6:this.measure();break;case 21:this.polyhedra();break;case 20:this.ellipsoid();break;case 4:this.struts()}return null},"~N,~B,~A");l(c$,"macro",function(){var a=this.e.optParameterAsString(1);if(0!=a.length&&!this.chk){var c=JV.JC.getMacro(a);null==c?this.showString("macro "+a+" could not be found. Current macros include:\n"+JV.JC.getMacroList()):(this.showString("running "+c),this.e.cmdScript(4124,c,null))}});l(c$,"evalParallel",function(a,c){this.chk=this.e.chk;this.slen=this.e.slen;
var b=(new JS.ScriptEval).setViewer(this.vwr);b.historyDisabled=!0;b.compiler=new JS.ScriptCompiler(this.vwr);b.sm=c;try{b.restoreScriptContext(a,!0,!1,!1),b.allowJSThreads=!1,b.dispatchCommands(!1,!1,!1)}catch(e){if(M(e,Exception))return this.e.vwr.setStringProperty("_errormessage",""+e),null==b.thisContext&&(JU.Logger.error("Error evaluating context "+e),this.vwr.isJS||e.printStackTrace()),!1;throw e;}return!0},"JS.ScriptContext,JV.ShapeManager");l(c$,"getBitsetIdent",function(a,c,b,e,f,d){var g=
!I(b,JM.BondSet);g&&(null==c?c=this.vwr.getStandardLabelFormat(0):0==c.length&&(c="%[label]"));var h=null==c?-1:c.indexOf("%"),j=2147483647!=f;if(null==a||this.chk||g&&0>h)return null==c&&(c=""),d?z(-1,[c]):c;var h=this.vwr.ms,A=0,m=h.getLabeler();b=g||!e?null:b.associatedAtoms;null==b&&(null!=c&&0<c.indexOf("%D"))&&(b=this.vwr.ms.getAtomIndices(a));e=null==c||0==c.length;var k=g||e?null:JM.LabelToken.getBondLabelValues();c=e?null:g?m.compile(this.vwr,c,"\x00",null):m.compile(this.vwr,c,"\u0001",
k);var l=j?1:a.cardinality(),q=Array(l),y=new JU.P3;for(f=j?f:a.nextSetBit(0);0<=f;f=a.nextSetBit(f+1)){var s;g?s=e?h.at[f].getInfo():m.formatLabelAtomArray(this.vwr,h.at[f],c,"\x00",b,y):(s=h.bo[f],s=e?s.getIdentity():m.formatLabelBond(this.vwr,s,c,k,b,y));s=JU.PT.formatStringI(s,"#",A+1);q[A++]=s;if(j)break}return 1==l&&!d?q[0]:q},"JU.BS,~S,~O,~B,~N,~B");l(c$,"getLoadSymmetryParams",function(a,c,b){var e=this.e;this.chk=e.chk;this.slen=e.slen;var f=null,d=this.tokAt(a);if(1073742332==d||8==d)f=
this.getPoint3f(a,!1),a=e.iToken+1,d=this.tokAt(a);switch(d){case 1073741938:case 1073742080:case 1094713350:case 1073742163:case 1073742114:case 1073742152:case 1814695966:null==f&&(f=JU.P3.new3(555,555,-1)),e.iToken=a-1}d=null;if(null!=f){b.put("lattice",f);a=e.iToken+1;c.append(" {"+K(f.x)+" "+K(f.y)+" "+K(f.z)+"}");a=this.checkPacked(a,b,c);1094713350==this.tokAt(a)&&(b.put("centroid",Boolean.TRUE),c.append(" CENTROID"),a=this.checkPacked(++a,b,c));if(1073742163==this.tokAt(a)){var g;c.append(" SUPERCELL ");
if(e.isPoint3f(++a)){g=this.getPoint3f(a,!1);if(g.x!=K(g.x)||g.y!=K(g.y)||g.z!=K(g.z)||1>g.x||1>g.y||1>g.z)e.iToken=a,this.invArg();a=e.iToken}else g=this.stringParameter(a);c.append(JU.Escape.e(g));b.put("supercell",g);a=this.checkPacked(++a,b,c)}g=0;1073742114==this.tokAt(a)&&(a++,g=this.floatParameter(a++),c.append(" range "+g));b.put("symmetryRange",Float.$valueOf(g));g=null;g=-2147483648;1073742152==this.tokAt(a)&&(++a,g=JU.PT.rep(this.paramAsStr(a++),"''",'"'),c.append(" spacegroup "+JU.PT.esc(g)),
g.equalsIgnoreCase("ignoreOperators")?g=-999:(0==g.length?(f=this.vwr.getCurrentUnitCell(),null!=f&&(g=f.getSpaceGroupName())):0<=g.indexOf(",")&&9>f.x&&(9>f.y&&0==f.z)&&(g+="#doNormalize=0"),b.put("spaceGroupName",g),g=-2));var h=null;if(1814695966==this.tokAt(a)){++a;0==e.optParameterAsString(a).length?(f=this.vwr.getCurrentUnitCell(),null!=f&&(h=f.getUnitCellAsArray(!0),d=f.getCartesianOffset())):h=e.floatParameterSet(a,6,9);(null==h||6!=h.length&&9!=h.length)&&this.invArg();c.append(" unitcell {");
for(a=0;a<h.length;a++)c.append((0==a?"":" ")+h[a]);c.append("}");b.put("unitcell",h);-2147483648==g&&(g=-1);a=e.iToken+1}-2147483648!=g&&b.put("spaceGroupIndex",Integer.$valueOf(g))}null!=d?e.coordinatesAreFractional=!1:1073742066==this.tokAt(a)&&(d=this.getPoint3f(++a,!0));null!=d&&(e.coordinatesAreFractional?(d.setT(e.fractionalPoint),b.put("unitCellOffsetFractional",e.coordinatesAreFractional?Boolean.TRUE:Boolean.FALSE),c.append(" offset {"+d.x+" "+d.y+" "+d.z+"/1}")):c.append(" offset "+JU.Escape.eP(d)),
b.put("unitCellOffset",d),a=e.iToken+1);return a},"~N,JU.SB,java.util.Map");l(c$,"checkPacked",function(a,c,b){switch(this.tokAt(a)){case 1073741938:c.put("packed",Boolean.TRUE);var e=null,f=this.tokAt(++a);switch(f){case 1814695966:case 1678381065:break;default:this.e.isArrayParameter(a)?(e=this.e.getPointArray(a,-1,!1),a=this.e.iToken):this.isFloatParameter(a)?(e=this.floatParameter(a),e=z(-1,[new JU.P3,JU.P3.new3(e,e,e)])):(e=[],--a)}a++;if(this.e.chk)break;switch(f){case 1814695966:if(e=this.vwr.getCurrentUnitCell(),
null!=e){e=JU.BoxInfo.getUnitCellPoints(e.getUnitCellVerticesNoOffset(),e.getCartesianOffset());break}case 1678381065:e=JU.BoxInfo.getUnitCellPoints(this.vwr.ms.getBBoxVertices(),null)}switch(e.length){case 2:f=e[1];e=z(-1,[e[0],JU.P3.newP(e[0]),new JU.P3,new JU.P3]);e[1].x=f.x;e[2].y=f.y;e[3].z=f.z;break;case 3:e=z(-1,[new JU.P3,e[0],e[1],e[2]]);break;case 4:break;default:e=z(-1,[new JU.P3,JU.P3.new3(10,0,0),JU.P3.new3(0,10,0),JU.P3.new3(0,0,10)])}c.put("fillRange",e);b.append(" FILL ["+e[0]+e[1]+
e[2]+e[3]+"]");break;case 1073742080:e=NaN,this.isFloatParameter(++a)&&(e=this.floatParameter(a++)),this.e.chk||(c.put("packed",Boolean.TRUE),b.append(" PACKED"),Float.isNaN(e)||(c.put("packingError",Float.$valueOf(e)),b.append(" "+e)))}return a},"~N,java.util.Map,JU.SB");l(c$,"cache",function(){var a=this.tokAt(1),c=null,b=2;switch(a){case 1275069441:case 1073742119:c=this.e.optParameterAsString(b++);case 1073741882:this.checkLength(b);this.chk||("all".equals(c)&&(c=null),c=this.vwr.cacheFileByName(c,
1275069441==a),this.showString(0>c?"cache cleared":c+" bytes "+(1275069441==a?" cached":" removed")));break;default:this.invArg()}});l(c$,"calculate",function(){var a=!1,c=!1,b=null,e=null,f=this.e,d=-2147483648;if(2<=(f.iToken=f.slen))switch(f.clearDefinedVariableAtomSets(),this.getToken(1).tok){case 1073741824:this.checkLength(2);break;case 1631586315:this.checkLength(2);if(this.chk)return;d=this.vwr.calculateFormalCharges(null);this.showString(J.i18n.GT.i(J.i18n.GT._("{0} charges modified"),d));
return;case 1075838996:this.checkLength(2);this.chk||this.vwr.ms.assignAromaticBondsBs(!0,null);return;case 1613238294:2!=f.slen&&(b=(c=1639976963==this.tokAt(++f.iToken))?this.vwr.bsA():this.atomExpressionAt(f.iToken),!c&&1639976963!=this.tokAt(++f.iToken)&&(e=this.atomExpressionAt(f.iToken)));if(this.chk)return;d=this.vwr.autoHbond(b,e,!1);-2147483648!=d&&f.report(J.i18n.GT.i(J.i18n.GT._("{0} hydrogen bonds"),Math.abs(d)),!1);return;case 1612709900:(a=1073742335==this.tokAt(2))&&f.iToken++;b=this.slen==
(a?3:2)?null:this.atomExpressionAt(a?3:2);f.checkLast(f.iToken);this.chk||(this.vwr.addHydrogens(b,!1,!1),a&&(null==b&&(b=this.vwr.bsA()),this.vwr.makeConnections(0.1,1E8,515,1073742025,b,b,null,!1,!1,0),this.vwr.ms.assignAromaticBondsBs(!0,null)));return;case 1111492619:f.iToken=1;b=2==this.slen?null:this.atomExpressionAt(2);f.checkLast(f.iToken);if(!this.chk)try{this.vwr.calculatePartialCharges(b)}catch(g){if(M(g,JV.JmolAsyncException))f.loadFileResourceAsync(g.getFileName());else throw g;}return;
case 1088421903:case 134217762:this.chk||(1275203608==this.tokAt(2)?(a=4==this.tokAt(3)?this.stringParameter(3):null,b=null!=a||3==this.slen?null:this.atomExpressionAt(3),b=z(-1,[null,a,b]),this.showString(f.getShapePropertyData(21,"symmetry",b)?b[1]:"")):this.showString(this.vwr.ms.calculatePointGroup(this.vwr.bsA())));return;case 1111490574:this.checkLength(2);this.chk||(this.vwr.calculateStraightness(),this.vwr.addStateScript("set quaternionFrame '"+this.vwr.getQuaternionFrame()+"'; calculate straightness",
!1,!0));return;case 1639976963:b=4>this.slen?null:this.atomExpressionAt(2);switch(this.tokAt(++f.iToken)){case 4138:break;case 1073741916:if(this.chk)return;f.showString(this.vwr.getAnnotationParser(!0).calculateDSSRStructure(this.vwr,b));return;case 1073741915:c=!0;break;case 0:c=this.vwr.getBoolean(603979826);break;default:this.invArg()}this.chk||this.showString(this.vwr.calculateStructures(b,c,!0));return;case 659482:b=f.iToken+1<this.slen?this.atomExpressionAt(++f.iToken):null;e=f.iToken+1<this.slen?
this.atomExpressionAt(++f.iToken):null;this.checkLength(++f.iToken);this.chk||(d=this.vwr.calculateStruts(b,e),0<d&&(this.setShapeProperty(1,"type",Integer.$valueOf(32768)),f.setShapePropertyBs(1,"color",Integer.$valueOf(16777215),null),f.setShapeTranslucency(1,"","translucent",0.5,null),this.setShapeProperty(1,"type",Integer.$valueOf(1023))),this.showString(J.i18n.GT.i(J.i18n.GT._("{0} struts added"),d)));return;case 2097180:a=!0;case 1111490575:c=!1;switch(this.tokAt(2)){case 134217759:f.iToken++;
break;case 0:c=!a;break;case 1073741952:c=!0;f.iToken++;break;default:c=!0}b=f.iToken+1<this.slen?this.atomExpressionAt(++f.iToken):this.vwr.bsA();this.checkLength(++f.iToken);this.chk||this.vwr.calculateSurface(b,c?3.4028235E38:-1);return}f.errorStr2(53,"CALCULATE","aromatic? hbonds? hydrogen? formalCharge? partialCharge? pointgroup? straightness? structure? struts? surfaceDistance FROM? surfaceDistance WITHIN?")});l(c$,"capture",function(){if(!this.chk&&!this.vwr.allowCapture())this.showString("Cannot capture on this platform");
else{var a=this.vwr.captureParams,c=null==a?"GIF":a.get("type"),b=0,e=0,f=this.e.slen,d="",g=1073742070!=this.vwr.am.animationReplayMode,h=1,j=this.tokAt(h),A=603979967==j;A&&(j=this.tokAt(++h));switch(0==j?j=102409:j){case 4:d=this.e.optParameterAsString(h++);if(0==d.length){e=102409;break}c=d.toLowerCase();c.endsWith(".gift")||c.endsWith(".pngt")?(A=!0,d=d.substring(0,d.length-1),c=d.toLowerCase()):!c.endsWith(".gif")&&!c.contains(".png")&&(d+=".gif");c.endsWith(".png")?(c.endsWith("0.png")||(d=
d.substring(0,d.length-4)+"0000.png"),c="PNG"):c="GIF";A&&(c+="T");a=d.indexOf("0000.");j=0>a||a!=d.lastIndexOf(".")-4;a=!1;528411==this.tokAt(h)&&(g=!0,this.tokAt(++h));switch(this.tokAt(h)){case 1073742129:a=!0;case 1611141175:b=null;g="y";h++;a?(h<f&&2!=this.tokAt(h)&&(g=this.e.optParameterAsString(h++).toLowerCase()),b="rotate Y 10 10;rotate Y -10 -10;rotate Y -10 -10;rotate Y 10 10",f=h<f?this.intParameter(h++):5,b=0>f?JU.PT.rep(b,"10;",""+-f+";"):JU.PT.rep(b,"10",""+f)):(h<f&&(g=this.e.optParameterAsString(h++).toLowerCase()),
b="rotate Y 360 30;");if(this.chk)return;this.vwr.setNavigationMode(!1);if(""===g||0>"xyz".indexOf(g))g="y";f=this.vwr.g.waitForMoveTo;b="set waitformoveto true;"+JU.PT.rep(b,"Y",g)+";set waitformoveto "+f;b="capture "+(A?"transparent ":"")+JU.PT.esc(d)+" LOOP;"+b+";capture end;";this.e.cmdScript(0,null,b);return;case 3:case 2:b=this.floatParameter(h++)}if(this.chk)return;e=1073742032;a=new java.util.Hashtable;A=this.vwr.getInt(553648132);j&&(a.put("streaming",Boolean.TRUE),g||this.showString(J.i18n.GT.o(J.i18n.GT._("Note: Enable looping using {0}"),
z(-1,["ANIMATION MODE LOOP"]))),this.showString(J.i18n.GT.o(J.i18n.GT._("Animation delay based on: {0}"),z(-1,["ANIMATION FPS "+A]))));a.put("captureFps",Integer.$valueOf(A));break;case 102409:case 1073741874:null!=a&&a.put("captureSilent",Boolean.TRUE);case 1073742335:case 1073742334:this.checkLength(-2);e=j;break;default:this.invArg()}this.chk||null==a||(a.put("type",c),A=Integer.$valueOf(this.vwr.getBackgroundArgb()),a.put("backgroundColor",A),a.put("fileName",d),a.put("quality",Integer.$valueOf(-1)),
a.put("endTime",Long.$valueOf(0>=b?-1:System.currentTimeMillis()+S(1E3*b))),a.put("captureMode",JS.T.nameOf(e).toLowerCase()),a.put("captureLooping",g?Boolean.TRUE:Boolean.FALSE),d=this.vwr.processWriteOrCapture(a),null==d&&(d="canceled"),JU.Logger.info(d))}});l(c$,"centerAt",function(){var a=this.getToken(1).tok;switch(a){case 1073741826:case 96:case 1678381065:break;default:this.invArg()}var c=JU.P3.new3(0,0,0);5==this.slen?(c.x=this.floatParameter(2),c.y=this.floatParameter(3),c.z=this.floatParameter(4)):
this.e.isCenterParameter(2)?(c=this.centerParameter(2),this.e.checkLast(this.e.iToken)):this.checkLength(2);!this.chk&&!this.vwr.isJmolDataFrame()&&this.vwr.tm.setCenterAt(a,c)});l(c$,"compare",function(){var a=this.e,c=!1,b=!1,e=!1,f=!1,d=!1,g=null,h=null,j=null,A=null,m=null,k=null;a.iToken=0;var l=this.isFloatParameter(1)?this.floatParameter(++a.iToken):NaN,q=this.atomExpressionAt(++a.iToken),y=null,s=null;a.isArrayParameter(++a.iToken)?y=a.getPointArray(a.iToken,-1,!1):1140850689!=this.tokAt(a.iToken)&&
(s=this.atomExpressionAt(a.iToken));var n=null,r=!1,u=null,x=JU.BSUtil.copy(q);null!=s&&x.or(s);for(var x=f=null==y&&null!=s&&x.equals(q),t=a.iToken+1;t<this.slen;++t)switch(this.getToken(t).tok){case 4115:x=!0;break;case 134218757:if(r=!0,4!=this.tokAt(t+1)){u="*";break}case 134218756:u=this.stringParameter(++t);break;case 1677721602:b=d=!0;u=this.paramAsStr(++t);u.equalsIgnoreCase("SMILES")&&(r=!0,u="*");break;case 3:case 2:l=Math.abs(this.floatParameter(t));break;case 268435504:break;case 2109448:n=
this.atomExpressionAt(++t);t=a.iToken;break;case 10:case 1073742325:null!=k&&this.invArg();var j=this.atomExpressionAt(a.iToken),C=f?0:this.tokAt(a.iToken+1),A=null==y&&a.isArrayParameter(a.iToken+1)?null:10==C||1073742325==C?this.atomExpressionAt(++a.iToken):JU.BSUtil.copy(j);null!=n&&(j.and(n),null!=A&&A.and(n));null==A?y=a.getPointArray(++a.iToken,-1,!1):A.and(s);null==m&&(m=new JU.Lst);m.addLast(z(-1,[j,A]));t=a.iToken;break;case 7:null!=m&&this.invArg();c=!0;g=a.getQuaternionArray(a.theToken.getList(),
1073742001);this.getToken(++t);h=a.getQuaternionArray(a.theToken.getList(),1073742001);null==k&&(k=new JU.Lst);k.addLast(z(-1,[g,h]));break;case 1073742077:c=!0;break;case 134217751:case 1140850689:c=!1;break;case 528432:b=!0;break;case 4160:e=!0;break;default:this.invArg()}if(!this.chk){x&&(l=0);Float.isNaN(l)||0>l?l=1:!b&&!e&&(b=e=!0);f=0!=l;(C=!c&&null==u||null!=y)&&J.api.Interface.getInterface("JU.Eigen",this.vwr,"script");null==m&&null==k&&(null==n?(j=C?this.vwr.getAtomBitSet("spine"):new JU.BS,
0>j.nextSetBit(0)?(j=q,A=s):(A=JU.BSUtil.copy(j),j.and(q),A.and(s))):(j=JU.BSUtil.copy(q),A=JU.BSUtil.copy(s),j.and(n),A.and(n),j.and(q),A.and(s)),m=new JU.Lst,m.addLast(z(-1,[j,A])));if(x){q=this.vwr.ms.getModelBS(q,!1);n=Array(q.cardinality());t=0;for(A=q.nextSetBit(0);0<=A;A=q.nextSetBit(A+1),t++)n[t]=this.vwr.getModelUndeletedAtomsBitSet(A)}else n=z(-1,[q]);for(A=0;A<n.length;A++){for(var q=n[A],v=L(2,0),p=null,w=new JU.Lst,B=null,G=x?new JU.Lst:m,t=0;t<m.size();++t){var H=m.get(t);x&&G.addLast(H=
z(-1,[JU.BSUtil.copy(H[0]),H[1]]));H[0].and(q)}var F=null,E=null;if(C){null!=y&&(G.clear(),G.addLast(z(-1,[j,y])));try{B=this.vwr.getCenterAndPoints(G,!0)}catch(K){if(M(K,Exception))this.invArg();else throw K;}p=B[0].length-1;for(t=1;t<=p;t++){w=B[0][t];H=B[1][t];if(!I(w,JM.Atom)||!I(H,JM.Atom))break;JU.Logger.info(" atom 1 "+w.getInfo()+"\tatom 2 "+H.getInfo())}p=JU.Measure.calculateQuaternionRotation(B,v);t=Float.isNaN(v[1])?NaN:Math.round(100*v[0])/100;v=Float.isNaN(v[1])?NaN:Math.round(100*v[1])/
100;this.showString("RMSD "+t+" --\x3e "+v+" Angstroms")}else if(c){if(null==k)for(t=0;t<G.size();t++){H=G.get(t);g=this.vwr.getAtomGroupQuaternions(H[0],2147483647);h=this.vwr.getAtomGroupQuaternions(H[1],2147483647);for(p=0;p<g.length&&p<h.length;p++)w.addLast(h[p].div(g[p]))}else for(p=0;p<g.length&&p<h.length;p++)w.addLast(h[p].div(g[p]));v[0]=0;g=w.toArray(Array(w.size()));p=JU.Quat.sphereMean(g,v,1E-4);this.showString("RMSD = "+v[0]+" degrees")}else{t=new JU.M4;F=new JU.P3;if(("*".equals(u)||
"".equals(u))&&null!=q)try{u=this.vwr.getSmiles(q)}catch(P){if(M(P,Exception))a.evalError(P.getMessage(),null);else throw P;}if(d){var N;if(null==q||null==s||null==(N=a.getSmilesExt().getFlexFitList(q,s,u,!r)))break;this.vwr.setDihedrals(N,null,1)}v=a.getSmilesExt().getSmilesCorrelation(q,s,u,null,null,t,null,!1,null,F,!1,r?1:2);System.out.println("compare:\n"+t);if(Float.isNaN(v)){this.showString("structures do not match");break}e&&(E=new JU.V3,t.getTranslation(E));b&&(p=new JU.M3,t.getRotationScale(p),
p=JU.Quat.newM(p));this.showString("RMSD = "+v+" Angstroms")}null!=B&&(F=B[0][0]);null==F&&(B=this.vwr.getCenterAndPoints(G,!0),F=B[0][0]);G=new JU.P3;v=NaN;e&&(null==E&&(E=JU.V3.newVsub(B[1][0],F)),v=1E10);b&&(null==p&&a.evalError("option not implemented",null),G.add2(F,p.getNormal()),v=p.getTheta(),0==v&&e&&(0.01<E.length()?v=1E10:b=e=f=!1));if(!Float.isNaN(v)&&!Float.isNaN(G.x)&&(B=null,b&&(e&&0!=l)&&(B=this.vwr.ms.getAtomPointVector(q),t=JS.ScriptMathProcessor.getMatrix4f(p.getMatrix(),E),B=JU.Measure.transformPoints(B,
t,F)),a.useThreads()||(f=!1),this.vwr.rotateAboutPointsInternal(a,F,G,v/l,v,f,q,E,B,null,null)&&f&&a.isJS))throw new JS.ScriptInterruption(a,"compare",1);}}});l(c$,"configuration",function(){var a=null,c=this.vwr.bsA();if(1==this.slen){if(this.chk)return;a=this.vwr.ms.setConformation(c);this.vwr.ms.addStateScript("select",null,c,null,"configuration",!0,!1)}else if(this.isFloatParameter(1)){c=this.intParameter(this.e.checkLast(1));if(this.chk)return;a=this.vwr.ms.getConformation(this.vwr.am.cmi,c-
1,!0,null);this.vwr.addStateScript("configuration "+c+";",!0,!1)}else{a=this.atomExpressionAt(1);if(this.chk)return;c=this.intParameter(this.e.checkLast(this.e.iToken+1));this.vwr.addStateScript("configuration "+JU.Escape.eBS(a)+" "+c+";",!0,!1);a=this.vwr.ms.getConformation(this.vwr.am.cmi,c-1,!0,a)}this.setShapeProperty(1,"type",Integer.$valueOf(30720));this.e.setShapeSizeBs(1,0,a);this.vwr.autoHbond(a,a,!0);this.vwr.select(a,!1,0,this.e.tQuiet)});l(c$,"measure",function(){var a=this.e,c=null,b=
0,e=null;if(2==this.slen)switch(this.tokAt(1)){case 1073742334:this.setShapeProperty(6,"hideAll",Boolean.TRUE);return;case 12291:this.chk||this.vwr.clearAllMeasurements();return}this.vwr.shm.loadShape(6);switch(this.tokAt(1)){case 134218756:var f=this.stringParameter(3==this.slen?2:4);if(this.chk)return;var d=this.vwr.ms.at,c=this.vwr.ms.ac,b=null;try{b=this.vwr.getSmilesMatcher().getCorrelationMaps(f,d,c,this.vwr.bsA(),2)}catch(g){if(M(g,Exception))a.evalError(g.getMessage(),null);else throw g;}if(null==
b)return;this.setShapeProperty(6,"maps",b);return}switch(this.slen){case 2:switch(this.getToken(1).tok){case 0:case 1073742335:this.vwr.shm.loadShape(6);this.setShapeProperty(6,"hideAll",Boolean.FALSE);return;case 1073742001:this.chk||a.showStringPrint(this.vwr.getMeasurementInfoAsString(),!1);return;case 4:this.setShapeProperty(6,"setFormats",this.stringParameter(1));return}a.errorStr(24,"ON, OFF, DELETE");break;case 3:switch(this.getToken(1).tok){case 12291:if(1073742327==this.getToken(2).tok)this.chk||
this.vwr.clearAllMeasurements();else{var h=this.intParameter(2)-1;this.chk||this.vwr.deleteMeasurement(h)}return}}for(var j=0,A=0,m=-1,k=-1,l=-1,q=E(5,0),y=L(-1,[3.4028235E38,3.4028235E38]),s=!1,n=!1,r=!1,u=!0,x=null,t=null,f=268435538,z=d=null,v=new JU.Lst,p=new JU.BS,w=null,B=null,G=0,H=0,h=1;h<this.slen;++h)switch(this.getToken(h).tok){case 1073741974:1!=h&&this.invArg();c=a.optParameterAsString(++h);continue;case 1073741824:a.errorStr(24,"ALL, ALLCONNECTED, DELETE");break;default:this.error(15);
break;case 268435568:134217736!=this.tokAt(h+1)&&this.invArg();h++;r=!0;break;case 134217736:case 1073741834:case 1073742327:n=1073741834==a.theTok;k=-1;s=!0;n&&r&&this.invArg();break;case 1765808134:b=JU.C.getColix(a.getArgbParam(++h));h=a.iToken;break;case 1073742066:a.isPoint3f(++h)?(e=this.getPoint3f(h,!1),e=L(-1,[1,e.x,e.y,e.z,0,0,0])):e=a.floatParameterSet(h,7,7);h=a.iToken;break;case 1665140738:case 1073741917:H=K((1665140738==a.theTok?2E3:1E3)*this.floatParameter(++h));null!=c&&0>=H&&(H=-1);
break;case 3:null!=x&&this.invArg();u=s=!0;l=(l+1)%2;y[l]=this.floatParameter(h);break;case 12291:268435538!=f&&this.invArg();f=12291;break;case 4114:var F=this.floatParameter(++h),N=this.paramAsStr(++h),O=this.paramAsStr(++h);this.chk||(z=this.vwr.getFont3D(N,O,F));break;case 2:F=this.intParameter(h);if(s)u=!0,l=(l+1)%2,y[l]=F;else{k=this.vwr.ms.getFirstAtomIndexFromAtomNumber(F,this.vwr.getVisibleFramesBitSet());if(!this.chk&&0>k)return;null!=w&&this.invArg();4<(q[0]=++j)&&a.bad();q[j]=k}break;
case 1094713359:m=this.intParameter(++h);break;case 1073742334:268435538!=f&&this.invArg();f=1073742334;break;case 1073742335:268435538!=f&&this.invArg();f=1073742335;break;case 1073742114:u=s=!0;k=-1;break;case 1073741989:case 1073741990:t=Boolean.$valueOf(1073741989==a.theTok);s=!0;r=1073741990==a.theTok;break;case 1648363544:0<=l&&this.invArg();x=a.encodeRadiusParameter(h,!1,!0);if(null==x)return;x.values=y;h=a.iToken;s=r=!0;t=Boolean.$valueOf(!1);1==G&&(G++,j++,F=JU.BSUtil.copy(p),JU.BSUtil.invertInPlace(F,
this.vwr.ms.ac),F.and(this.vwr.ms.getAtomsWithinRadius(5,p,!1,null)),v.addLast(F));break;case 10:case 1073742325:case 1073742332:case 8:case 1073742330:(10==a.theTok||1073742325==a.theTok)&&G++;0<=k&&this.invArg();j=Array(1);w=a.centerParameter(h,j);if(I(j[0],JU.BS)&&(w=p=j[0],!this.chk&&0==p.length()))return;I(w,JU.P3)&&(h=new JU.Point3fi,h.setT(w),h.mi=m,w=h);4<(j=++A)&&a.bad();h=a.iToken;v.addLast(w);break;case 4:d=this.stringParameter(h);break;case 1073742164:B=a.tickParamAsStr(h,!1,!0,!0),h=
a.iToken,f=12290}(null!=x&&(0<=l||2!=j)||2>j&&null==c&&(null==B||1==j))&&a.bad();null!=d&&0!=d.indexOf(j+":")&&(d=j+":"+d);u&&y[1]<y[0]&&(y[1]=y[0],y[0]=3.4028235E38==y[1]?3.4028235E38:-200);if(!this.chk)if(null!=w||null!=B)null==x&&(x=new J.atomdata.RadiusData(y,0,null,null)),null==w&&(B.id="default"),null!=w&&(null!=d&&268435538==f)&&(f=12290),a=null,null!=z&&(a=J.api.Interface.getInterface("JM.Text",this.vwr,"script").newLabel(this.vwr,z,"",b,0,0,0)),null!=a&&(a.pymolOffset=e),this.setShapeProperty(6,
"measure",this.vwr.newMeasurementData(c,v).set(f,null,x,d,null,B,n,r,t,s,H,b,a));else switch(a=null==c?q:c,f){case 12291:this.setShapeProperty(6,"delete",a);break;case 1073742335:this.setShapeProperty(6,"show",a);break;case 1073742334:this.setShapeProperty(6,"hide",a);break;default:this.setShapeProperty(6,null==d?"toggle":"toggleOn",a),null!=d&&this.setShapeProperty(6,"setFormats",d)}});l(c$,"connect",function(a){var c=this.e,b=L(2,0),e=Array(2);e[0]=e[1]=this.vwr.bsA();var f=NaN,d=E(-1,[-2147483648]),
g=0,h=131071,j=1073742026,A=!1,m=!1,k=!1,l=3.4028235E38,q=!1,y=0,s=0,n=new JU.BS,r=!1,u=0,x=0,t=0,C=!1;if(1==this.slen)this.chk||this.vwr.rebondState(c.$isStateScript);else{for(;a<this.slen;++a){switch(this.getToken(a).tok){case 1073742335:case 1073742334:this.checkLength(2);this.chk||this.vwr.rebondState(c.$isStateScript);return;case 2:case 3:if(0<y){(m||q)&&c.error(23);h=JU.Edge.getBondOrderFromFloat(this.floatParameter(a));131071==h&&this.invArg();m=!0;break}2<++s&&c.bad();var v=this.floatParameter(a);
268435634==this.tokAt(a+1)&&(v=-v/100,a++);b[g++]=v;break;case 10:case 1073742325:(2<y||r&&0<y)&&c.bad();(m||q)&&this.invArg();e[y++]=this.atomExpressionAt(a);r=c.isBondSet;if(2==y){for(var v=c.iToken,p=a;p<v;p++)if(1073741824==this.tokAt(p)&&this.paramAsStr(p).equals("_1")){u=a;break}c.iToken=v}a=c.iToken;break;case 1086324742:C=!0;break;case 1765808134:case 603979967:case 1073742074:q=!0;l=this.getColorTrans(c,a,!1,d);a=c.iToken;break;case 1073742086:d=1073741852==this.tokAt(2);this.checkLength(d?
3:2);if(this.chk)return;this.vwr.clearModelDependentObjects();this.vwr.ms.deleteAllBonds();f=new JU.BS;this.vwr.ms.setPdbConectBonding(0,0,f);if(d){c=c.$isStateScript&&this.vwr.getBoolean(603979873);this.vwr.ms.autoBondBs4(null,null,f,null,this.vwr.getMadBond(),c);this.vwr.addStateScript(c?"set legacyAutoBonding TRUE;connect PDB AUTO;set legacyAutoBonding FALSE;":"connect PDB auto;",!1,!0);return}this.vwr.addStateScript("connect PDB;",!1,!0);return;case 1073741830:case 1073741852:case 1073741904:case 1073742025:case 1073742026:k=
!0;++a!=this.slen&&this.invArg();j=c.theTok;1073741852==j&&!(131071==h||2048==h||515==h)&&this.invArg();break;case 659482:q||(d[0]=16777215,l=0.5,f=this.vwr.getFloat(570425406),q=!0),k||(j=1073742026),k=!0;case 1073741824:if(c.isColorParam(a)){x=-a;break}case 1075838996:case 1613238294:h=this.paramAsStr(a);131071==(h=JS.ScriptParam.getBondOrderFromString(h))&&this.invArg();m&&c.error(18);m=!0;switch(h){case 33:switch(this.tokAt(a+1)){case 3:h=JS.ScriptParam.getPartialBondOrderFromFloatEncodedInt(this.st[++a].intValue);
break;case 2:h=this.intParameter(++a)}break;case 2048:2==this.tokAt(a+1)&&(h=this.intParameter(++a)<<11,t=this.floatParameter(++a))}break;case 1665140738:f=this.floatParameter(++a);q=!0;break;case 1073742333:case 12291:++a!=this.slen&&this.invArg();j=12291;A=!0;q=!1;break;default:x=a}0<a&&(x==-a||x==a&&c.isColorParam(a)?(q=!0,d[0]=c.getArgbParam(a),a=c.iToken):x==a&&this.invArg())}if(!this.chk){2>g&&(0==g&&(b[0]=1E8),b[1]=b[0],b[0]=0.1);q&&(m||(h=65535),k||(j=1073742025));m=g=0;if(0<u){t=new JU.BS;
this.vwr.definedAtomSets.put("_1",t);C=e[0];for(k=C.nextSetBit(0);0<=k;k=C.nextSetBit(k+1))t.set(k),e=this.vwr.makeConnections(b[0],b[1],h,j,t,this.atomExpressionAt(u),n,r,!1,0),g+=Math.abs(e[0]),m+=e[1],t.clear(k)}else e=this.vwr.makeConnections(b[0],b[1],h,j,e[0],e[1],n,r,C,t),g+=Math.abs(e[0]),m+=e[1];b=c.doReport();A?b&&c.report(J.i18n.GT.i(J.i18n.GT._("{0} connections deleted"),m),!1):(q&&(this.vwr.selectBonds(n),Float.isNaN(f)||c.setShapeSizeBs(1,Math.round(2E3*f),null),this.finalizeObject(1,
d[0],l,0,!1,null,0,n),this.vwr.selectBonds(null)),b&&c.report(J.i18n.GT.o(J.i18n.GT._("{0} new bonds; {1} modified"),z(-1,[Integer.$valueOf(g),Integer.$valueOf(m)])),!1))}}},"~N");l(c$,"console",function(){switch(this.getToken(1).tok){case 1073742334:this.chk||this.vwr.showConsole(!1);break;case 1073742335:this.chk||this.vwr.showConsole(!0);break;case 1073741882:this.chk||this.vwr.sm.clearConsole();break;case 134221856:this.showString(this.stringParameter(2));break;default:this.invArg()}});l(c$,"data",
function(){var a=this.e,c=null,b=null,e=!1,f;switch(a.iToken=this.slen){case 5:c=this.paramAsStr(2);case 4:case 2:b=this.paramAsStr(1);if(b.equalsIgnoreCase("clear")){this.chk||this.vwr.setData(null,null,0,0,0,0,0);return}if(0<=(f=b.indexOf("@")))c=""+a.getParameter(b.substring(f+1),4,!0),b=b.substring(0,f).trim();else if(null==c&&0<=(f=b.indexOf(" ")))c=b.substring(f+1).trim(),b=b.substring(0,f).trim(),e=!0;break;default:a.bad()}f=b.substring(0,(b+" ").indexOf(" ")).toLowerCase();if(f.equals("model")||
f.equals("append"))a.cmdLoad();else if(!this.chk){var d=0<=b.toLowerCase().indexOf("(default)");if(f.equals("connect_atoms"))this.vwr.ms.connect(this.parseDataArray(c,!1));else if(0==f.indexOf("ligand_"))this.vwr.setLigandModel(b.substring(7).toUpperCase()+"_data",c.trim());else if(0==f.indexOf("file_"))this.vwr.setLigandModel(b.substring(5)+"_file",c.trim());else if(a=Array(4),f.equals("element_vdw")){a[0]=f;a[1]=c.$replace(";","\n");c=JU.Elements.elementNumberMax;f=E(c+1,0);for(d=1;d<=c;d++)f[d]=
d;a[2]=f;a[3]=Integer.$valueOf(0);this.vwr.setData("element_vdw",a,c,0,0,0,0)}else if(0==f.indexOf("data2d_"))a[0]=b,a[1]=this.parseDataArray(c,!1),a[3]=Integer.$valueOf(2),this.vwr.setData(b,a,0,0,0,0,0);else if(0==f.indexOf("data3d_"))a[0]=b,a[1]=this.parseDataArray(c,!0),a[3]=Integer.$valueOf(3),this.vwr.setData(b,a,0,0,0,0,0);else{var g=JU.PT.getTokens(b);if(0==f.indexOf("property_")&&!(2==g.length&&g[1].equals("set"))){d=this.vwr.bsA();a[0]=f;var h=e?0:this.vwr.getP("propertyAtomNumberField").intValue(),
j=e?0:this.vwr.getP("propertyAtomNumberColumnCount").intValue(),A=e?-2147483648:this.vwr.getP("propertyDataField").intValue(),m=e?0:this.vwr.getP("propertyDataColumnCount").intValue();!e&&0<=b.indexOf(" ")&&(3==g.length&&(h=JU.PT.parseInt(g[1]),A=JU.PT.parseInt(g[2])),5==g.length&&(h=JU.PT.parseInt(g[1]),j=JU.PT.parseInt(g[2]),A=JU.PT.parseInt(g[3]),m=JU.PT.parseInt(g[4])));0>h&&(h=0);0>A&&(A=0);b=this.vwr.ms.ac;e=null;g=JU.BS.newN(b);if(0<h){for(var e=E(b+2,0),k=0;k<=b;k++)e[k]=-1;for(k=d.nextSetBit(0);0<=
k;k=d.nextSetBit(k+1)){var l=this.vwr.ms.at[k].getAtomNumber();l>b+1||(0>l||g.get(l))||(g.set(l),e[l]=k)}a[2]=e}else a[2]=JU.BSUtil.copy(d);a[1]=c;a[3]=Integer.$valueOf(0);this.vwr.setData(f,a,b,h,j,A,m)}else"occupany".equals(f)&&(f="occupancy"),h=JM.AtomCollection.getUserSettableType(f),-1<h?this.vwr.setAtomData(h,f,c,d):(a[0]=b,a[1]=c,a[3]=Integer.$valueOf(0),this.vwr.setData(f,a,0,0,0,0,0))}}});l(c$,"ellipsoid",function(){var a=this.e,c=0,b=1,e=3.4028235E38,f=!1,d=!1;this.setShapeProperty(20,"thisID",
null);switch(this.getToken(1).tok){case 1073742335:c=2147483647;break;case 1073742334:break;case 2:c=this.intParameter(1);break;case 36867:this.e.sm.loadShape(20);this.setShapeProperty(20,"select",this.paramAsStr(2));b=a.iToken;d=f=!0;break;case 1073741974:case 268435633:case 1073741824:this.e.sm.loadShape(20);1073741974==a.theTok&&b++;this.setShapeId(20,b,!1);b=a.iToken;f=!0;break;default:this.invArg()}if(f){for(c=E(-1,[-2147483648]);++b<this.slen;){var f=this.paramAsStr(b),g=null;this.getToken(b);
if(!d)switch(a.theTok){case 1073742330:f="points";g=Array(3);g[0]=a.objectNameParameter(++b);if(this.chk)continue;a.getShapePropertyData(24,"getVertices",g);break;case 1611272194:for(var g=Array(3),h=0;3>h;h++)g[h]=new JU.V3,g[h].setT(this.centerParameter(++b)),b=a.iToken;break;case 12289:g=this.centerParameter(++b);b=a.iToken;break;case 1094713359:g=Integer.$valueOf(this.intParameter(++b));break;case 12291:g=Boolean.TRUE,this.checkLength(b+1)}if(null==g)switch(a.theTok){case 1073742335:f="on";g=
Boolean.TRUE;break;case 1073742334:f="on";g=Boolean.FALSE;break;case 1073742138:g=Float.$valueOf(this.floatParameter(++b));break;case 10:case 1073742325:f="atoms";g=this.atomExpressionAt(b);b=a.iToken;break;case 1765808134:case 603979967:case 1073742074:e=this.getColorTrans(a,b,!0,c);b=a.iToken;continue;case 1073742075:g=this.paramAsStr(++b)}null==g&&this.invArg();this.setShapeProperty(20,f.toLowerCase(),g)}this.finalizeObject(20,c[0],e,0,!1,null,0,null);this.setShapeProperty(20,"thisID",null)}else a.setShapeSizeBs(20,
c,null)});l(c$,"image",function(){this.chk||this.vwr.getConsole();var a=1,c=null;1073741974==this.tokAt(1)&&(c=this.e.optParameterAsString(++a),a++);var b=this.e.optParameterAsString(a),e=this.e.optParameterAsString(this.slen-1).equalsIgnoreCase("close");if(!e&&(this.slen==a||this.slen==a+2))b=this.slen==a+2?this.intParameter(a++):-1,a=0>b?-1:this.intParameter(a),e=new java.util.Hashtable,e.put("fileName","\u0001\u0001"+c),e.put("backgroundColor",Integer.$valueOf(this.vwr.getBackgroundArgb())),e.put("type",
"png"),e.put("quality",Integer.$valueOf(-1)),e.put("width",Integer.$valueOf(b)),e.put("height",Integer.$valueOf(a)),this.chk||this.vwr.processWriteOrCapture(e);else{if(e)switch(this.slen){case 2:b="closeall";break;case 3:case 4:break;default:this.checkLength(0)}this.chk||this.vwr.fm.loadImage(e?"\u0001close":b,"\u0001"+b+"\u0001"+("".equals(c)||null==c?null:c),!1)}});l(c$,"mapProperty",function(){for(var a,c,b,e,f,d=0,g=0,h=0,j=this.e;;){if(1113589787==this.tokAt(1))a=this.vwr.bsA(),c=this.atomExpressionAt(2),
b=e="selected";else{a=this.atomExpressionAt(1);if(1073742336!=this.tokAt(++j.iToken)||!JS.T.tokAttr(d=this.tokAt(++j.iToken),1077936128))break;b=this.paramAsStr(j.iToken);c=this.atomExpressionAt(++j.iToken);if(1073742336!=this.tokAt(++j.iToken)||!JS.T.tokAttr(g=this.tokAt(++j.iToken),2048))break;e=this.paramAsStr(j.iToken)}f=JS.T.tokAttr(h=this.tokAt(j.iToken+1),1077936128)?this.paramAsStr(++j.iToken):JS.T.nameOf(h=1094715393);j.checkLast(j.iToken);if(this.chk)return;var l=null;this.showString("mapping "+
b.toUpperCase()+" for "+a.cardinality()+" atoms to "+e.toUpperCase()+" for "+c.cardinality()+" atoms using "+f.toUpperCase());if(JS.T.tokAttrOr(d,1094713344,1111490560)&&JS.T.tokAttrOr(g,1094713344,1111490560)&&JS.T.tokAttrOr(h,1094713344,1111490560)){var m=this.getBitsetPropertyFloat(a,d|224,null,NaN,NaN),k=this.getBitsetPropertyFloat(a,h|224,null,NaN,NaN),d=this.getBitsetPropertyFloat(c,h|224,null,NaN,NaN),D=1715472409==g,q=L(D?this.vwr.ms.ac:d.length,0),l=new JU.BS;if(m.length==k.length){for(var y=
new java.util.Hashtable,h=0;h<m.length;h++)y.put(Float.$valueOf(k[h]),Float.$valueOf(m[h]));m=-1;for(h=k=0;h<d.length;h++){var m=c.nextSetBit(m+1),s=y.get(Float.$valueOf(d[h]));null!=s&&(l.set(m),q[D?m:k]=s.floatValue(),k++)}D?this.vwr.setData(e,z(-1,[e,q,l,Integer.$valueOf(1),Boolean.TRUE]),this.vwr.ms.ac,0,0,2147483647,0):this.vwr.setAtomProperty(l,g,0,0,null,q,null)}}if(null==l){b=this.getBitsetIdent(a,"{"+f+"=%["+f+"]}."+e+" = %["+b+"]",null,!1,2147483647,!1);a=new JU.SB;for(h=0;h<b.length;h++)0>
b[h].indexOf("null")&&a.append(b[h]).appendC("\n");JU.Logger.debugging&&JU.Logger.debug(a.toString());b=JU.BSUtil.copy(this.vwr.slm.bsSubset);this.vwr.slm.setSelectionSubset(c);try{j.runScript(a.toString())}catch(n){if(M(n,Exception))c=n,this.vwr.slm.setSelectionSubset(b),j.errorStr(-1,"Error: "+c.getMessage());else if(M(n,Error))c=n,this.vwr.slm.setSelectionSubset(b),j.errorStr(-1,"Error: "+c.toString());else throw n;}this.vwr.slm.setSelectionSubset(b)}this.showString("DONE");return}this.invArg()});
l(c$,"minimize",function(){for(var a=null,c=2147483647,b=0,e=!1,f=!1,d=null,g=!1,h=this.vwr.getMinimizer(!1),j=1;j<this.slen;j++)switch(this.getToken(j).tok){case 1073741828:e=!0;continue;case 1073741874:case 1073742162:this.checkLength(2);if(this.chk||null==h)return;h.setProperty(this.paramAsStr(j),null);return;case 1073741882:this.checkLength(2);if(this.chk||null==h)return;h.setProperty("clear",null);return;case 1073741894:1!=j&&this.invArg();c=a=0;b=E(5,0);if(1073741882==this.tokAt(++j))this.checkLength(3);
else{for(;4>a&&!this.isFloatParameter(j);)b[++a]=this.atomExpressionAt(j).nextSetBit(0),j=this.e.iToken+1;b[0]=a;1==a&&this.invArg();c=this.floatParameter(this.e.checkLast(j))}this.chk||this.vwr.getMinimizer(!0).setProperty("constraint",z(-1,[b,E(a,0),Float.$valueOf(c)]));return;case 1073741905:b=this.floatParameter(++j);continue;case 1073741934:c=0;continue;case 12293:1!=j&&this.invArg();d=this.atomExpressionAt(++j);0>d.nextSetBit(0)&&(d=null);j=this.e.iToken;this.chk||this.vwr.getMinimizer(!0).setProperty("fixed",
d);if(j+1==this.slen)return;continue;case 10:case 1073742325:g=!0;case 1275082245:1275082245==this.e.theTok&&j++;a=this.atomExpressionAt(j);j=this.e.iToken;1073742072==this.tokAt(j+1)&&(j++,g=!0);continue;case 1073742148:f=!0;break;case 266298:c=this.intParameter(++j);continue;default:this.invArg()}if(!this.chk)try{this.vwr.minimize(this.e,c,b,a,d,0,e,g,f,!1)}catch(l){if(M(l,Exception))throw new JS.ScriptInterruption(this.e,"minimize",1);throw l;}});l(c$,"modulation",function(){var a=null,c=this.e,
b=!0,e=!1,f=null,d=1;switch(this.getToken(d).tok){case 1073742334:b=!1;case 0:case 1073742335:break;case 10:case 1073742325:f=this.atomExpressionAt(1);switch(this.tokAt(c.iToken+1)){case 1073742334:b=!1;case 1073742335:c.iToken++}c.checkLast(c.iToken);break;case 1073742332:case 8:a=c.getPoint3f(1,!1);e=1073742335==this.tokAt(c.iToken+1);break;default:var g=c.theToken.value.toString();d++;g.equalsIgnoreCase("t")?c.theTok=3:g.equalsIgnoreCase("m")||g.equalsIgnoreCase("q")?c.theTok=2:this.invArg();case 3:case 2:switch(c.theTok){case 3:this.isFloatParameter(d)?
(a=this.floatParameter(d),a=JU.P3.new3(a,a,a)):a=c.getPoint3f(d,!1);break;case 2:2==this.tokAt(d)?(e=this.intParameter(d),a=JU.P3.new3(e,e,e)):a=c.getPoint3f(d,!1),e=!0}break;case 1073742138:b=this.floatParameter(2);this.chk||this.vwr.setFloatProperty("modulationScale",b);return}this.chk||(this.vwr.tm.setVibrationPeriod(0),this.vwr.setModulation(f,b,a,e))});l(c$,"mutate",function(){var a,c;switch(this.tokAt(1)){case 2:this.st[1]=JS.T.o(4,""+this.st[1].value);default:a=this.atomExpressionAt(1);c=++this.e.iToken;
break;case 268435633:a=this.vwr.getAllAtoms(),c=2}a.and(this.vwr.getModelUndeletedAtomsBitSet(this.vwr.ms.mc-1));var b=a.length()-1;if(!(0>b||this.vwr.ms.at[b].mi+1!=this.vwr.ms.mc||this.vwr.ms.isTrajectory(this.vwr.ms.at[b].mi)))if(b=this.e.optParameterAsString(c),this.e.checkLast(c),!this.chk&&this.vwr.ms.am[this.vwr.ms.mc-1].isBioModel){var e=null;if(4==this.tokAt(c)&&!b.startsWith("~"))e=z(-1,[b]),b=null;else{b=JU.PT.replaceAllCharacters(b,",; \t\n"," ").trim().toUpperCase();if((c=b.startsWith("~"))||
3!=b.length||!this.vwr.getJBR().isKnownPDBGroup(b,20))b=this.vwr.getJBR().toStdAmino3(c?b.substring(1):b);e=JU.PT.getTokens(b)}0<e.length&&this.vwr.ms.bioModelset.mutate(a,b,e)}});l(c$,"navigate",function(){var a=this.e;if(1==this.slen)a.setBooleanProperty("navigationMode",!0);else{var c=JU.V3.new3(0,1,0),b=new JU.Lst,e;if(2==this.slen)switch(this.getToken(1).tok){case 1073742335:case 1073742334:if(this.chk)return;a.setObjectMad10(34,"axes",10);this.setShapeProperty(34,"position",JU.P3.new3(50,50,
3.4028235E38));a.setBooleanProperty("navigationMode",!0);this.vwr.tm.setNavOn(1073742335==a.theTok);return;case 1073742162:this.chk||this.vwr.tm.setNavXYZ(0,0,0);return;case 8:case 1112152078:break;default:this.invArg()}!this.chk&&!this.vwr.getBoolean(603979889)&&a.setBooleanProperty("navigationMode",!0);for(var f=1;f<this.slen;f++){var d=this.isFloatParameter(f)?this.floatParameter(f++):2;0>d&&this.invArg();!this.chk&&0<d&&a.refresh(!1);switch(this.getToken(f).tok){case 8:case 1073742332:e=this.getPoint3f(f,
!0);a.iToken++;a.iToken!=this.slen&&this.invArg();this.chk||this.vwr.tm.setNavXYZ(e.x,e.y,e.z);return;case 554176526:e=this.floatParameter(++f);this.chk||b.addLast(z(-1,[Integer.$valueOf(554176526),Float.$valueOf(d),Float.$valueOf(e)]));continue;case 12289:e=this.centerParameter(++f);f=a.iToken;this.chk||b.addLast(z(-1,[Integer.$valueOf(134217751),Float.$valueOf(d),e]));continue;case 528432:switch(this.getToken(++f).tok){case 1111492629:c.set(1,0,0);f++;break;case 1111492630:c.set(0,1,0);f++;break;
case 1111492631:c.set(0,0,1);f++;break;case 8:case 1073742332:c.setT(this.getPoint3f(f,!0));f=a.iToken+1;break;case 1073741824:this.invArg()}e=this.floatParameter(f);this.chk||b.addLast(z(-1,[Integer.$valueOf(528432),Float.$valueOf(d),c,Float.$valueOf(e)]));continue;case 4160:var g=e=NaN;if(this.isFloatParameter(++f))e=this.floatParameter(f),g=this.floatParameter(++f);else switch(this.tokAt(f)){case 1111492629:e=this.floatParameter(++f);break;case 1111492630:g=this.floatParameter(++f);break;default:e=
this.centerParameter(f);f=a.iToken;this.chk||b.addLast(z(-1,[Integer.$valueOf(4160),Float.$valueOf(d),e]));continue}this.chk||b.addLast(z(-1,[Integer.$valueOf(268435634),Float.$valueOf(d),Float.$valueOf(e),Float.$valueOf(g)]));continue;case 268435632:continue;case 1112152078:e=new JU.Lst;10==this.tokAt(f+1)||1073742325==this.tokAt(f+1)?(g=this.atomExpressionAt(++f),f=a.iToken):g=this.vwr.bsA();if(this.chk)return;this.vwr.getPolymerPointsAndVectors(g,e);var h;if(0<(h=e.size())){for(var g=Array(h),
j=0;j<h;j++)g[j]=e.get(j);b.addLast(z(-1,[Integer.$valueOf(1112152078),Float.$valueOf(d),g]));continue}break;case 1073742084:if(1073742330==this.getToken(f+1).tok){f++;e=a.objectNameParameter(++f);if(this.chk)return;this.setShapeProperty(22,"thisID",e);e=this.getShapeProperty(22,"vertices");a.refresh(!1);null==e&&this.invArg();g=K(this.isFloatParameter(f+1)?this.floatParameter(++f):0);h=K(this.isFloatParameter(f+1)?this.floatParameter(++f):2147483647);b.addLast(z(-1,[Integer.$valueOf(1073742084),
Float.$valueOf(d),e,null,E(-1,[g,h])]));continue}for(e=new JU.Lst;a.isCenterParameter(f+1);)e.addLast(this.centerParameter(++f)),f=a.iToken;if(0<e.size()){e=e.toArray(Array(e.size()));this.chk||b.addLast(z(-1,[Integer.$valueOf(1073742084),Float.$valueOf(d),e,null,E(-1,[0,2147483647])]));continue}default:this.invArg()}}!this.chk&&!this.vwr.isJmolDataFrame()&&this.vwr.tm.navigateList(a,b)}});l(c$,"plot",function(a){var c=this.e,b=this.vwr.am.cmi;0>b&&c.errorStr(30,"plot");var b=this.vwr.ms.getJmolDataSourceFrame(b),
e=a.length-1,f=a!==this.st,d=!0,g=this.st;f&&(c.st=this.st=a);var h=f?134222350:a[0].tok,j=f||134221850==h||4138==h?0:1,l=null,m=!0,k=!1;switch(h){case 135176:m=!1;k=!0;break;case 134222350:d=m=!1;break;case 134221856:m=!1,4==JS.CmdExt.tokAtArray(e,a)?l=this.stringParameter(e--):1073742336==JS.CmdExt.tokAtArray(e-1,a)?(l=this.paramAsStr(e-2)+"."+this.paramAsStr(e),e-=3):(c.st=this.st=g,c.iToken=this.st.length,this.error(13)),c.slen=this.slen=e+1}var f="",D=null,q="",y=!1,s=!1,n=!1,r=!1,u=Array(3),
x=E(3,0),t=JU.BSUtil.copy(this.vwr.bsA()),C="; select "+JU.Escape.eBS(t)+";\n ",r=c.optParameterAsString(e).toLowerCase(),v=null,p=null,w=null,B=JS.CmdExt.tokAtArray(j,a);4==B&&(B=JS.T.getTokFromName(a[j].value));switch(B){default:c.iToken=1;this.invArg();break;case 134221834:c.iToken=1;r="data";C="";break;case 1715472409:c.iToken=j+1;for(a=0;3>a;a++){switch(this.tokAt(c.iToken)){case 4:x[a]=JS.T.getTokFromName(c.getToken(c.iToken).value);break;default:x[a]=this.tokAt(c.iToken);break;case 0:0==a&&
this.invArg();case 1287653388:case 32:case 64:a=2;continue}1715472409!=x[a]&&!JS.T.tokAttr(x[a],1077936128)&&this.invArg();u[a]=this.getToken(c.iToken).value.toString();c.iToken++}1287653388==this.tokAt(c.iToken)&&(w=this.stringParameter(++c.iToken),d=!1,c.iToken++);32==this.tokAt(c.iToken)&&(v=this.getPoint3f(++c.iToken,!1),c.iToken++);64==this.tokAt(c.iToken)&&(p=this.getPoint3f(++c.iToken,!1),c.iToken++);r="property "+u[0]+(null==u[1]?"":" "+u[1])+(null==u[2]?"":" "+u[2]);0>t.nextSetBit(0)&&(t=
this.vwr.getModelUndeletedAtomsBitSet(b));q="select "+JU.Escape.eBS(t)+";\n ";break;case 4138:r.equalsIgnoreCase("draw")&&(r=c.optParameterAsString(--e).toLowerCase());r=e>j&&r.startsWith("r");r="ramachandran"+(r?" r":"")+(135176==h?" draw":"");break;case 134221850:case 136314895:f=' "'+this.vwr.getQuaternionFrame()+'"';q="set quaternionFrame"+f+";\n  ";y=!0;r.equalsIgnoreCase("draw")&&(k=!0,r=c.optParameterAsString(--e).toLowerCase());n=(s=r.startsWith("deriv")||r.startsWith("diff"))&&0<r.indexOf("2");
s&&e--;if(r.equalsIgnoreCase("helix")||r.equalsIgnoreCase("axis"))s=k=!0,e=-1;r=((e<=j?"":c.optParameterAsString(e))+"w").substring(0,1);if(r.equals("a")||r.equals("r"))s=!0;JU.PT.isOneOf(r,";w;x;y;z;r;a;")||c.evalError("QUATERNION [w,x,y,z,a,r] [difference][2]",null);r="quaternion "+r+(s?" difference":"")+(n?"2":"")+(k?" draw":"")}this.st=g;if(this.chk)return"";if(m&&(q+="plot "+r,g=this.vwr.ms.getJmolDataFrameIndex(b,q),0<g&&134221856!=h&&134222350!=h))return this.vwr.setCurrentModelIndexClear(g,
!0),"";m=e=g=null;j=Array(3);if(1715472409==B){g=this.getBitsetPropertyFloat(t,x[0]|224,1715472409==x[0]?u[0]:null,null==v?NaN:v.x,null==p?NaN:p.x);j[0]=u[0]+" "+JU.Escape.eAF(g);null!=u[1]&&(e=this.getBitsetPropertyFloat(t,x[1]|224,1715472409==x[1]?u[1]:null,null==v?NaN:v.y,null==p?NaN:p.y),j[1]=u[1]+" "+JU.Escape.eAF(e));null!=u[2]&&(m=this.getBitsetPropertyFloat(t,x[2]|224,1715472409==x[2]?u[2]:null,null==v?NaN:v.z,null==p?NaN:p.z),j[2]=u[2]+" "+JU.Escape.eAF(m));null==v&&(v=JU.P3.new3(this.getPlotMinMax(g,
!1,x[0]),this.getPlotMinMax(e,!1,x[1]),this.getPlotMinMax(m,!1,x[2])));null==p&&(p=JU.P3.new3(this.getPlotMinMax(g,!0,x[0]),this.getPlotMinMax(e,!0,x[1]),this.getPlotMinMax(m,!0,x[2])));JU.Logger.info("plot min/max: "+v+" "+p);k=D=null;if(d){k=JU.P3.new3(1,1,1);D=new JU.P3;D.ave(p,v);k.sub2(p,v);k.set(k.x/200,k.y/200,k.z/200);JS.T.tokAttr(x[0],1094713344)?(k.x=1,D.x=0):0.1<k.x&&10>=k.x&&(k.x=1);JS.T.tokAttr(x[1],1094713344)?(k.y=1,D.y=0):0.1<k.y&&10>=k.y&&(k.y=1);JS.T.tokAttr(x[2],1094713344)?(k.z=
1,D.z=0):0.1<k.z&&10>=k.z&&(k.z=1);if(null==u[2]||null==u[1])D.z=v.z=p.z=k.z=0;for(a=0;a<g.length;a++)g[a]=(g[a]-D.x)/k.x;if(null!=u[1])for(a=0;a<e.length;a++)e[a]=(e[a]-D.y)/k.y;if(null!=u[2])for(a=0;a<m.length;a++)m[a]=(m[a]-D.z)/k.z}D=z(-1,[t,g,e,m,v,p,k,D,w,j])}if(134221856==h)return this.vwr.writeFileData(l,"PLOT_"+r,b,D);d=r.equals("data")?"1 0 H 0 0 0 # Jmol PDB-encoded data":this.vwr.getPdbData(b,r,null,D,null,!0);if(134222350==h)return d;JU.Logger.debugging&&JU.Logger.debug(d);if(135176==
h)return c.runScript(d),"";h=this.vwr.fm.getFileInfo();l=this.vwr.getBoolean(603979792);this.vwr.g.appendNew=!0;d=null!=d&&null==this.vwr.openStringInlineParamsAppend(d,null,!0);this.vwr.g.appendNew=l;this.vwr.fm.setFileInfo(h);if(!d)return"";h=this.vwr.ms.mc;this.vwr.ms.setJmolDataFrame(q,b,h-1);1715472409!=B&&(q+=";\n"+C);q=this.vwr.addStateScript(q,!0,!1);d=150;switch(B){default:b="frame 0.0; frame last; reset;select visible;wireframe only;";d=10;break;case 1715472409:this.vwr.setFrameTitle(h-
1,r+" plot for model "+this.vwr.getModelNumberDotted(b));b="frame 0.0; frame last; reset;select visible; spacefill 3.0; wireframe 0;draw plotAxisX"+h+' {100 -100 -100} {-100 -100 -100} "'+u[0]+'";draw plotAxisY'+h+' {-100 100 -100} {-100 -100 -100} "'+u[1]+'";';null!=u[2]&&(b+="draw plotAxisZ"+h+' {-100 -100 100} {-100 -100 -100} "'+u[2]+'";');break;case 4138:this.vwr.setFrameTitle(h-1,"ramachandran plot for model "+this.vwr.getModelNumberDotted(b));b="frame 0.0; frame last; reset;select visible; color structure; spacefill 3.0; wireframe 0;draw ramaAxisX"+
h+' {100 0 0} {-100 0 0} "phi";draw ramaAxisY'+h+' {0 100 0} {0 -100 0} "psi";';break;case 134221850:case 136314895:this.vwr.setFrameTitle(h-1,r.$replace("w"," ")+f+" for model "+this.vwr.getModelNumberDotted(b)),b=JU.C.getHexCode(this.vwr.cm.colixBackgroundContrast),b="frame 0.0; frame last; reset;select visible; wireframe 0; spacefill 3.0; isosurface quatSphere"+h+" color "+b+" sphere 100.0 mesh nofill frontonly translucent 0.8;draw quatAxis"+h+'X {100 0 0} {-100 0 0} color red "x";draw quatAxis'+
h+'Y {0 100 0} {0 -100 0} color green "y";draw quatAxis'+h+'Z {0 0 100} {0 0 -100} color blue "z";color structure;draw quatCenter'+h+"{0 0 0} scale 0.02;"}c.runScript(b+C);q.setModelIndex(this.vwr.am.cmi);this.vwr.setRotationRadius(d,!0);c.sm.loadShape(31);this.showString("frame "+this.vwr.getModelNumberDotted(h-1)+(0<r.length?" created: "+r+(y?f:""):""));return""},"~A");l(c$,"polyhedra",function(){var a=this.e,c=1==this.slen,b=!1,e=c,f=!1,d=!1,g=!1,h=NaN,j=0;a.sm.loadShape(21);this.setShapeProperty(21,
"init",Boolean.TRUE);for(var l=3.4028235E38,m=-1,k=E(-1,[-2147483648]),z=-1,q=null,y=null,s=!1,n=1;n<this.slen;++n){var r=null,u=null;switch(this.getToken(n).tok){case 6:r="info";u=this.e.theToken.value;e=!0;break;case 134217751:r="points";u=Float.$valueOf(1073742334==this.tokAt(++n)?0:this.e.floatParameter(n));s=!0;break;case 1073742138:h=this.floatParameter(++n);s=!0;continue;case 1814695966:null!=y&&this.invArg();r="unitCell";u=Boolean.TRUE;e=!0;break;case 1073742072:this.e.restrictSelected(!1,
!1),a.theTok=1073742335;case 1073742335:case 12291:case 1073742334:(n+1!=this.slen||e||1<j)&&this.error(18);r=1073742334==a.theTok?"off":1073742335==a.theTok?"on":"delete";f=!0;break;case 1073741961:r="full";break;case 2:null!=y&&this.invArg();r="nVertices";u=Integer.$valueOf(this.intParameter(n));e=!0;268435504==this.tokAt(n+1)&&n++;break;case 1677721602:null!=y&&this.invArg();0<j&&this.invPO();e=!0;r="bonds";c=!0;break;case 1665140738:n++;case 3:null!=y&&this.invArg();0<j&&this.invPO();r=0!=m?"radius1":
"radius";u=Float.$valueOf(m=this.floatParameter(n));e=!0;break;case 1073742066:if(!this.isFloatParameter(n+1)){q=this.getPoint3f(++n,!0);n=a.iToken;s=!0;continue}case 1073741937:this.setShapeProperty(21,"collapsed",null);case 1073742099:case 1073741924:r=JS.T.nameOf(a.theTok);switch(this.tokAt(n+1)){case 268435860:case 268435504:n++}u=Float.$valueOf(this.floatParameter(++n));break;case 1094717454:null==y&&this.invArg();r="model";u=Integer.$valueOf(this.intParameter(++n));break;case 1073742170:(1<
j||null!=y&&!b||z==n)&&this.invPO();j=3;10==this.tokAt(++n)||1073742325==this.tokAt(n)?(r=e?"to":"toBitSet",u=this.atomExpressionAt(n)):a.isArrayParameter(n)?(r="toVertices",u=a.getPointArray(n,-1,!1)):this.error(19);n=a.iToken;e=!0;break;case 10:case 1073742325:d&&this.invPO();switch(++j){case 1:null!=y&&this.invArg();r="centers";break;case 2:r="to";e=!0;break;default:a.bad()}u=this.atomExpressionAt(n);n=a.iToken;e=(new Boolean(e|n+1==this.slen)).valueOf();break;case 1765808134:case 603979967:case 1073742074:l=
this.getColorTrans(a,n,!0,k);n=a.iToken;continue;case 1073741886:d&&this.error(18);d=!0;this.isFloatParameter(n+1)&&this.setShapeProperty(21,"faceCenterOffset",Float.$valueOf(this.floatParameter(++n)));r="collapsed";break;case 1073742044:case 1073741933:case 1073741956:g&&this.error(18);s=g=!0;r=JS.T.nameOf(a.theTok);break;case 1073742182:case 1073742060:case 1073741861:case 1073741958:case 1073741964:continue;case 1073741974:case 268435633:case 1073741824:case 4:if(!a.isColorParam(n)){1!=n&&this.invPO();
y=1073741974==a.theTok?this.stringParameter(++n):a.optParameterAsString(n);this.setShapeProperty(21,"thisID",y);this.setShapeProperty(21,"model",Integer.$valueOf(this.vwr.am.cmi));if(!a.isCenterParameter(n+1))continue;r="center";u=this.centerParameter(++n);n=a.iToken;b=!0;break}default:if(a.isColorParam(n)){k[0]=a.getArgbParam(n);a.isCenterParameter(n)&&(z=a.iToken+1);n=a.iToken;continue}this.invArg()}null!=r&&this.setShapeProperty(21,r,u);if(f)return}e?(!d&&c&&this.setShapeProperty(21,"bonds",null),
this.setShapeProperty(21,"generate",null)):s||this.error(19);null!=q&&this.setShapeProperty(21,"offset",q);Float.isNaN(h)||this.setShapeProperty(21,"scale",Float.$valueOf(h));-2147483648!=k[0]&&this.setShapeProperty(21,"colorThis",Integer.$valueOf(k[0]));3.4028235E38!=l&&a.setShapeTranslucency(21,"","translucentThis",l,null);this.setShapeProperty(21,"init",Boolean.FALSE)});l(c$,"write",function(a){var c=this.e,b=1,e=1,f=null,d=null,g=null,h=null,j="SPT",d=!0,l=!1;null==a?(a=this.st,l=this.vwr.isApplet&&
!this.vwr.isSignedApplet||!this.vwr.haveAccess(JV.Viewer.ACCESS.ALL)||0<this.vwr.fm.getPathForAllFiles().length):(b=e=0,d=!1,l=!d);var m=JS.CmdExt.tokAtArray(b,a);if(4==m&&!d){var k=JS.T.getTokenFromName(JS.SV.sValue(a[0]).toLowerCase());null!=k&&(m=k.tok)}switch(m){case 0:break;case 134221850:case 4138:case 1715472409:return d=this.plot(a),l?d:this.writeMsg(d);case 134222850:c.isArrayParameter(b+1)&&(f=c.stringParameterSet(++b),h=g=".",e=b=c.iToken+1,m=this.tokAt(b));break;default:j=JS.SV.sValue(this.tokenAt(b,
a)).toUpperCase()}var z=this.vwr.getExportDriverList(),k=null,q=d?this.slen:a.length,y="",s=null,n=null,r=0,u="PNGJ",x=!1,t=null,C=-1,v=-1,p=!1,w=null;0!=m&&(d&&1<this.slen&&1073741848==this.tokAt(this.slen-2))&&(j=this.paramAsStr(this.slen-1).toUpperCase(),e=q,q-=2,m=0);switch(m){case 15:case 6:j="VAR";n=this.tokenAt(b++,a);break;case 1073741983:j="INLINE";k=JS.SV.sValue(this.tokenAt(++b,a));b++;break;case 134217762:j="PGRP";b++;y=JS.SV.sValue(this.tokenAt(b,a)).toLowerCase();y.equals("draw")&&b++;
break;case 1073742329:b++;x=!0;break;case 1073742158:case 134222850:for(s=JS.SV.sValue(this.tokenAt(++b,a)).toLowerCase();s.equals("localpath")||s.equals("remotepath");)s.equals("localpath")?g=JS.SV.sValue(this.tokenAt(++b,a)):h=JS.SV.sValue(this.tokenAt(++b,a)),s=JS.SV.sValue(this.tokenAt(++b,a)).toLowerCase();j="SPT";break;case 1228935687:case 134320141:case 1610616855:case 135180:case 1073742015:case 1073742018:case 1073877011:case 1073877010:case 135188:b++;break;case 1073741991:j="ZIPALL";b++;
break;case 36868:j="VAR";b+=2;break;case 4115:case 4120:case 1073742139:case 4166:case 1073741824:case 4:switch(m){case 4115:var B;b+1<q&&1073742325==a[++b].tok||10==a[b].tok?(B=c.atomExpression(a,b,0,!0,!1,null,!0),b=c.iToken+1):B=this.vwr.getAllAtoms();this.chk||(t=this.vwr.ms.getModelBS(B,!0));break;case 4120:j="IMAGE";b++;break;case 1073742139:s=JS.SV.sValue(this.tokenAt(++b,a)).toUpperCase();JU.PT.isOneOf(s,";PNG;PNGJ;")&&(u=s,b++);break;case 4166:r=c.intParameterRange(++b,1,10);if(2147483647==
r)return"";this.chk||(this.vwr.tm.setVibrationPeriod(0),c.isJS||c.delayScript(100));b++;break;default:m=4120}if(4120==m&&b<a.length)if(m=JS.T.getTokenFromName(JS.SV.sValue(a[b]).toLowerCase()),null!=m&&(j=JS.SV.sValue(m).toUpperCase()),JU.PT.isOneOf(j,z.toUpperCase())){b++;j=j.substring(0,1).toUpperCase()+j.substring(1).toLowerCase();p=!0;d&&(w="Jmol."+j.toLowerCase());break}else if(JU.PT.isOneOf(j,";ZIP;ZIPALL;SPT;STATE;")){b++;break}else j="IMAGE";2==JS.CmdExt.tokAtArray(b,a)&&(C=JS.SV.iValue(this.tokenAt(b++,
a)),0>=C&&this.invArg(),v=JS.SV.iValue(this.tokenAt(b++,a)),0>=v&&this.invArg())}m=-2147483648;if(e<q){s=JS.SV.sValue(this.tokenAt(b,a));if(s.equalsIgnoreCase("clipboard")){if(this.chk)return""}else JU.PT.isOneOf(s.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;gift;pdf;ppm;png;pngj;pngt;")?(2==JS.CmdExt.tokAtArray(b+1,a)&&2==JS.CmdExt.tokAtArray(b+2,a)&&(C=JS.SV.iValue(this.tokenAt(++b,a)),0>=C&&this.invArg(),v=JS.SV.iValue(this.tokenAt(++b,a)),0>=v&&this.invArg()),2==JS.CmdExt.tokAtArray(b+1,a)&&(m=
JS.SV.iValue(this.tokenAt(++b,a)))):JU.PT.isOneOf(s.toLowerCase(),";xyz;xyzrn;xyzvib;mol;mol67;sdf;v2000;v3000;json;pdb;pqr;cml;")&&(j=s.toUpperCase(),b+1==q&&b++);j.equals("IMAGE")&&JU.PT.isOneOf(s.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;gift;pdf;ppm;png;pngj;pngt;scene;")&&(j=s.toUpperCase(),b++)}b+2==q&&(e=JS.SV.sValue(this.tokenAt(++b,a)),0<e.length&&"."!=e.charAt(0)&&(j=s.toUpperCase()));switch(JS.CmdExt.tokAtArray(b,a)){case 0:l=!0;break;case 1073741884:break;case 805306401:w=j.equals("IMAGE")?
"?jmol.png":"?jmol."+j.toLowerCase();break;case 1073741824:case 4:w=JS.SV.sValue(this.tokenAt(b,a));if(w.equalsIgnoreCase("clipboard")||!this.vwr.haveAccess(JV.Viewer.ACCESS.ALL))w=null;break;default:this.invArg()}if(j.equals("IMAGE")||j.equals("FRAME")||j.equals("VIBRATION"))j=null!=w&&0<=w.indexOf(".")?w.substring(w.lastIndexOf(".")+1).toUpperCase():"JPG";s=JU.PT.isOneOf(j.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;gift;pdf;ppm;png;pngj;pngt;scene;");if(!s&&(j.equals("MNU")?j="MENU":j.equals("WRL")||
j.equals("VRML")?(j="Vrml",p=!0):j.equals("X3D")?(j="X3d",p=!0):j.equals("IDTF")?(j="Idtf",p=!0):j.equals("MA")?(j="Maya",p=!0):j.equals("JS")?(j="Js",p=!0):j.equals("OBJ")?(j="Obj",p=!0):j.equals("JVXL")?j="ISOSURFACE":j.equals("XJVXL")?j="ISOSURFACE":j.equals("JMOL")?j="ZIPALL":j.equals("HIS")&&(j="HISTORY"),j.equals("COORD")||j.equals("COORDS")))j=null!=w&&0<=w.indexOf(".")?w.substring(w.lastIndexOf(".")+1).toUpperCase():"XYZ";null!=f&&(j.equals("PNG")&&(j="PNGJ"),!j.equals("PNGJ")&&(!j.equals("ZIPALL")&&
!j.equals("ZIP"))&&this.invArg());!s&&(!p&&!JU.PT.isOneOf(j,";SCENE;JMOL;ZIP;ZIPALL;SPT;HISTORY;MO;NBO;ISOSURFACE;MESH;PMESH;VAR;FILE;FUNCTION;CML;JSON;XYZ;XYZRN;XYZVIB;MENU;MOL;MOL67;PDB;PGRP;PQR;QUAT;RAMA;SDF;V2000;V3000;INLINE;"))&&c.errorStr2(54,"COORDS|FILE|FUNCTIONS|HISTORY|IMAGE|INLINE|ISOSURFACE|JMOL|MENU|MO|NBO|POINTGROUP|QUATERNION [w,x,y,z] [derivative]|RAMACHANDRAN|SPT|STATE|VAR x|ZIP|ZIPALL  CLIPBOARD","CML|GIF|GIFT|JPG|JPG64|JMOL|JVXL|MESH|MOL|PDB|PMESH|PNG|PNGJ|PNGT|PPM|PQR|SDF|CD|JSON|V2000|V3000|SPT|XJVXL|XYZ|XYZRN|XYZVIB|ZIP"+
z.toUpperCase().$replace(";","|"));if(this.chk)return"";b=Array(1);e=this.vwr.getBoolean(603979934);if(p){e&&JU.Logger.startTimer("export");k=new java.util.Hashtable;k.put("type",j);null!=w&&k.put("fileName",w);(d||null!=w)&&k.put("fullPath",b);k.put("width",Integer.$valueOf(C));k.put("height",Integer.$valueOf(v));k=this.vwr.generateOutputForExport(k);if(null==k||0==k.length)return"";if(l)return k;if(!j.equals("Povray")&&!j.equals("Idtf")||null==b[0])return this.writeMsg(k);l=j.equals("Idtf")?".tex":
".ini";w=b[0]+l;a=new java.util.Hashtable;a.put("fileName",w);a.put("type",l);a.put("text",k);a.put("fullPath",b);d=this.vwr.processWriteOrCapture(a);j.equals("Idtf")&&(k=k.substring(0,k.indexOf("\\begin{comment}")));k="Created "+b[0]+":\n\n"+k;e&&this.showString(JU.Logger.getTimerMsg("export",0));null!=d&&((j=!d.startsWith("OK"))&&c.evalError(d,null),c.report(k,j));return""}p=null;z=!1;if(null==k){q=0;k=j.intern();if("MENU"===k)k=this.vwr.getMenu("");else if("PGRP"===k)k=this.vwr.ms.getPointGroupAsString(this.vwr.bsA(),
null,0,1,null,null,y.equals("draw")?"":null);else if("PDB"===k||"PQR"===k)l?k=this.vwr.getPdbAtomData(null,null,"PQR"===k,x):(z=!0,j="PDB_"+k+"-coord "+x);else if("FILE"===k)"?".equals(w)&&(w="?Jmol."+this.vwr.getP("_fileType")),l?k=this.vwr.getCurrentFileAsString("script"):z=!0;else if("SDF"===k||"MOL"===k||"MOL67"===k||"V2000"===k||"V3000"===k||"CD"===k||"JSON"===k||"XYZ"===k||"XYZRN"===k||"XYZVIB"===k||"CML"===k)k=this.vwr.getModelExtract("selected",x,!1,k),k.startsWith("ERROR:")&&(p=k);else if("FUNCTION"===
k)k=this.vwr.getFunctionCalls(null),j="TXT";else if("VAR"===k)null==n&&(n=c.getParameter(JS.SV.sValue(this.tokenAt(d?2:1,a)),1073742190,!0)),g=null,15==n.tok?(g=new JU.Lst,g.addLast(n.value.data)):6==n.tok&&(g=null==w?new JU.Lst:this.prepareBinaryOutput(n)),null==g?(k=n.asString(),j="TXT"):null!=w&&(a=new java.util.Hashtable,a.put("data",g),null==(p=k=this.vwr.createZip(w,1==g.size()||w.endsWith(".png")||w.endsWith(".pngj")?"BINARY":"ZIPDATA",a))&&c.evalError("#CANCELED#",null));else if("SPT"===k)if(x)a=
this.vwr.ms.getTaintedAtoms(2),this.vwr.setAtomCoordsRelative(JU.P3.new3(0,0,0),null),k=this.vwr.getStateInfo(),this.vwr.ms.setTaintedAtoms(a,2);else{if(k=this.vwr.getStateInfo(),null!=g||null!=h)k=JV.FileManager.setScriptFileReferences(k,g,h,null)}else"ZIP"===k||"ZIPALL"===k?null!=w&&(a=new java.util.Hashtable,null!=f&&a.put("data",f),null==(p=k=this.vwr.createZip(w,j,a))&&c.evalError("#CANCELED#",null)):"HISTORY"===k?(k=this.vwr.getSetHistory(2147483647),j="SPT"):"MO"===k||"NBO"===k?(k=this.getMoJvxl(2147483647,
"NBO"===k),j="XJVXL"):"PMESH"===k?(null==(k=this.getIsosurfaceJvxl(!0,29))&&this.error(31),j="XJVXL"):"ISOSURFACE"===k||"MESH"===k?(null==(k=this.getIsosurfaceJvxl("MESH"===k,24))&&this.error(31),j=0<=k.indexOf("<?xml")?"XJVXL":"JVXL",l||this.showString(this.getShapeProperty(24,"jvxlFileInfo"))):(d&&(l&&null==w)&&(l=!1,w="\u0001"),q=-1,0>m&&(m=-1));null==k&&(k="");0==q&&(null==p||I(p,String))}if(!d)return k;if(l)return c.showStringPrint(k,!0),"";if(null!=p&&I(p,String))return this.writeMsg(p);if(z)return this.writeMsg(this.vwr.writeFileData(w,
j,0,null));if(j.equals("SCENE"))p=u;else if(null==p&&(!s||null!=w))p=k;e&&JU.Logger.startTimer("write");s&&(c.refresh(!1),0>C&&(C=this.vwr.getScreenWidth()),0>v&&(v=this.vwr.getScreenHeight()));a=new java.util.Hashtable;null!=w&&a.put("fileName",w);a.put("backgroundColor",Integer.$valueOf(this.vwr.getBackgroundArgb()));a.put("type",j);I(p,String)&&-2147483648==m?a.put("text",p):I(p,Array)&&a.put("bytes",p);null!=f&&a.put("scripts",f);null!=t&&a.put("bsFrames",t);a.put("fullPath",b);a.put("quality",
Integer.$valueOf(m));a.put("width",Integer.$valueOf(C));a.put("height",Integer.$valueOf(v));a.put("nVibes",Integer.$valueOf(r));d=this.vwr.processWriteOrCapture(a);null==d&&(d="canceled");s&&d.startsWith("OK")&&(d+="; width="+C+"; height="+v);e&&this.showString(JU.Logger.getTimerMsg("write",0));return this.writeMsg(d)},"~A");l(c$,"prepareBinaryOutput",function(a){var c=a.getMap();if(null==c||!c.containsKey("$_BINARY_$"))return null;a=new JU.Lst;for(var b,c=c.entrySet().iterator();c.hasNext()&&((b=
c.next())||1);){var e=b.getKey();if(!e.equals("$_BINARY_$")){var f=b.getValue(),d=15==f.tok?f.value.data:null;null==d&&(f=f.asString(),d=f.startsWith(";base64,")?JU.Base64.decodeBase64(f):f.getBytes());if(e.equals("_DATA_")){a=new JU.Lst;a.addLast(d);break}else e.equals("_IMAGE_")?(a.add(0,e),a.add(1,null),a.add(2,d)):(a.addLast(e),a.addLast(null),a.addLast(d))}}return a},"JS.SV");l(c$,"writeMsg",function(a){if(this.chk||null==a)return"";var c=!a.startsWith("OK");c&&(this.e.evalError(a,null),alert(a));
this.e.report(a,c);return a},"~S");l(c$,"show",function(){var a=this.e,c=null,b=this.paramAsStr(1),e=null,f=0;2<this.slen&&268435632==this.tokAt(this.slen-2)?(e="/"+this.paramAsStr(this.slen-1),this.slen-=2,f=2):0==(e=this.paramAsStr(this.slen-1)).lastIndexOf("/")?(this.slen--,f=1):e=null;var d=null,g=null,h=2,j=this.getToken(1),g=I(j,JS.SV)&&1073741824!=j.tok?0:j.tok;4==g&&(j=JS.T.getTokenFromName(b.toLowerCase()),null!=j&&(g=j.tok));1296041986!=g&&(1073742158!=g&&1715472409!=g&&1228935687!=g)&&
this.checkLength(-3);2==this.slen&&0<=b.indexOf("?")&&(d=this.vwr.getAllSettings(b.substring(0,b.indexOf("?"))),g=-1);switch(g){case 0:this.chk||(d=a.theToken.escape());break;case 1073741925:a.checkLength23();h=this.st.length;this.chk||(d=this.vwr.ms.getInfo(this.vwr.am.cmi,"domains"),d=I(d,JS.SV)?this.vwr.getAnnotationInfo(d,a.optParameterAsString(2),1073741925):"domain information has not been loaded");break;case 1715472409:d=this.plot(this.st);h=this.st.length;break;case 1073742189:a.checkLength23();
h=this.st.length;this.chk||(d=this.vwr.ms.getInfo(this.vwr.am.cmi,"validation"),d=I(d,JS.SV)?this.vwr.getAnnotationInfo(d,a.optParameterAsString(2),1073742189):"validation information has not been loaded");break;case 134221829:this.chk||(d=JU.Escape.e(this.vwr.fm.cacheList()));break;case 1073741916:a.checkLength23();h=this.st.length;this.chk||(d=this.vwr.ms.getInfo(this.vwr.am.cmi,"dssr"),d=null==d?"no DSSR information has been read":2<h?JS.SV.getVariable(this.vwr.extractProperty(d,this.stringParameter(2),
-1)).asString():""+JS.SV.getVariable(d).asString());break;case 1073741915:this.checkLength(2+f);this.chk||(d=this.vwr.calculateStructures(null,!0,!1));break;case 545259572:this.checkLength(2+f);this.chk||(d=this.vwr.fm.getPathForAllFiles());break;case 1275203608:this.chk||(j=Array(2),this.vwr.shm.getShapePropertyData(21,"allInfo",j),d=JS.SV.getVariable(j[1]).asString());break;case 1073742038:if(a.optParameterAsString(2).equalsIgnoreCase("1H")){h=3;this.chk||(d=this.vwr.getNMRPredict(!1));break}this.chk||
this.vwr.getNMRPredict(!0);return;case 1073741929:case 1073741879:case 134218757:this.checkLength((1073741879==g||134218757==g&&0!=this.tokAt(2)?h=3:2)+f);if(this.chk)return;try{134218757!=g?(d=this.vwr.getDataBaseName(null),d=null!=d&&(d.startsWith("$")||d.startsWith(":"))?d.substring(1):null):a.optParameterAsString(2).equalsIgnoreCase("true")?d=this.vwr.getBioSmiles(null):null!=e&&(d=this.vwr.getSmilesOpt(null,-1,-1,1,e+"///")),null==d&&(d=134218757==g?this.vwr.getSmiles(null):this.vwr.getOpenSmiles(null))}catch(l){if(M(l,
Exception))d=l.getMessage();else throw l;}switch(g){case 1073741929:if(0<d.length){this.vwr.fm.loadImage(this.vwr.setLoadFormat("_"+d,"2",!1),"\u0001"+d,!1);return}d="Could not show drawing -- Either insufficient atoms are selected or the model is a PDB file.";break;case 1073741879:h=3,0<d.length?(d=this.vwr.getChemicalInfo(d,this.getToken(2).value.toString()),0<=d.indexOf("FileNotFound")&&(d="?")):d="Could not show name -- Either insufficient atoms are selected or the model is a PDB file."}break;
case 1073742152:case 1296041986:d="";j=null;if(2==(h=this.slen)){if(this.chk)break;j=this.vwr.getSymTemp().getSpaceGroupInfo(this.vwr.ms,null,-1)}else if(1073742152==g){j=this.paramAsStr(2);h=3;if(this.chk)break;j=this.vwr.getSymTemp().getSpaceGroupInfo(this.vwr.ms,JU.PT.rep(j,"''",'"'),-1)}if(null!=j){d=(1073742152==g?""+j.get("spaceGroupInfo")+j.get("spaceGroupNote"):"")+j.get("symmetryInfo");break}var g=2==this.tokAt(2)?this.intParameter(2):0,j=4==this.tokAt(2)?this.paramAsStr(2):null,m=null,k=
null,D=-1;if(3<this.slen&&4!=this.tokAt(3)){h=z(-1,[null,this.vwr.getFrameAtoms()]);m=a.centerParameter(2+(0==g?0:1),h);if(null!=h[0]&&0==h[0].cardinality()){h=this.slen;break}h[0]=null;if(0==g&&(k=a.centerParameter(++a.iToken,h),null!=h[0]&&0==h[0].cardinality())){h=this.slen;break}2==this.tokAt(a.iToken+1)&&(D=a.getToken(++a.iToken).intValue)}var q=1<a.iToken&&4==this.tokAt(a.iToken+1)?this.stringParameter(++a.iToken):null;this.checkLength((h=++a.iToken)+f);this.chk||(d=this.vwr.getSymTemp().getSymmetryInfoAtom(this.vwr.ms,
this.vwr.getAllAtoms().nextSetBit(0),j,g,m,k,q,0,0,D),d=I(d,java.util.Map)?JS.SV.getVariable(d).asString():d.toString());break;case 1648363544:g=null;2<this.slen&&(g=J.c.VDW.getVdwType(this.paramAsStr(2)),null==g&&this.invArg());this.chk||(d=this.vwr.getDefaultVdwNameOrData(0,g,null));break;case 134320141:a.checkLength23();this.chk||(d=this.vwr.getFunctionCalls(a.optParameterAsString(2)));break;case 36867:this.checkLength(2+f);this.chk||(d=this.vwr.getAllSettings(null));break;case 1073742184:2==this.slen?
this.chk||this.vwr.showUrl(a.getFullPathName()):(g=this.paramAsStr(2),this.chk||this.vwr.showUrl(g));return;case 1765808134:b="defaultColorScheme";break;case 1610612740:b="scaleAngstromsPerInch";break;case 134221850:case 4138:if(this.chk)return;0>this.vwr.am.cmi&&a.errorStr(30,"show "+a.theToken.value);d=this.plot(this.st);h=this.slen;break;case 14:case 1112152078:this.chk||(d=this.getContext(!1));break;case 1073741888:g=a.optParameterAsString(2);0<g.length&&(h=3);this.chk||(c=this.vwr.cm.getColorSchemeList(g));
break;case 1073742192:this.chk||(d=this.vwr.getAtomDefs(this.vwr.definedAtomSets)+this.vwr.g.getVariableList()+this.getContext(!0));break;case 536870926:this.chk||(d=this.vwr.getTrajectoryState());break;case 553648148:c=""+JS.ScriptEval.commandHistoryLevelMax;break;case 553648150:c=""+JU.Logger.getLogLevel();break;case 603979825:c=""+this.vwr.getBoolean(603979825);break;case 553648178:d="set strandCountForStrands "+this.vwr.getStrandCount(12)+"; set strandCountForMeshRibbon "+this.vwr.getStrandCount(13);
break;case 536875070:d=this.vwr.showTimeout(2==(h=this.slen)?null:this.paramAsStr(2));break;case 536870918:c=JU.Escape.eP(this.vwr.getDefaultLattice());break;case 4126:this.chk||(d=this.vwr.getMinimizationInfo());break;case 1611272194:switch(this.vwr.g.axesMode){case 603979808:d="set axesUnitcell";break;case 603979804:d="set axesMolecular";break;default:d="set axesWindow"}break;case 1610612737:d="set bondMode "+(this.vwr.getBoolean(603979812)?"OR":"AND");break;case 1649022989:this.chk||(d="set strandCountForStrands "+
this.vwr.getStrandCount(12)+"; set strandCountForMeshRibbon "+this.vwr.getStrandCount(13));break;case 1613238294:d="set hbondsBackbone "+this.vwr.getBoolean(603979852)+";set hbondsSolid "+this.vwr.getBoolean(603979854);break;case 1611141175:this.chk||(d=this.vwr.getSpinState());break;case 1611141176:d="set ssbondsBackbone "+this.vwr.getBoolean(603979952);break;case 1610625028:case 1611141171:d="selectionHalos "+(this.vwr.getSelectionHalosEnabled()?"ON":"OFF");break;case 1612709894:d="set selectHetero "+
this.vwr.getBoolean(1612709894);break;case 1073741828:d=JU.Escape.eAP(this.vwr.getAdditionalHydrogens(null,!0,!0,null));break;case 1612709900:d="set selectHydrogens "+this.vwr.getBoolean(1612709900);break;case 553648130:case 553648142:case 536870924:case 553648176:case 553648172:case 1073741995:this.chk||(d=this.vwr.getLightingState());break;case 1073742136:case 4146:this.chk||(d=this.vwr.stm.listSavedStates());break;case 1814695966:this.chk||(d=this.vwr.getUnitCellInfoText());break;case 1073742329:if(2==
(h=this.slen)){this.chk||(d=this.vwr.getCoordinateState(this.vwr.bsA()));break}g=this.paramAsStr(2);this.chk||(d=this.vwr.stm.getSavedCoordinates(g));break;case 1073742158:!this.chk&&null==a.outputBuffer&&this.vwr.sm.clearConsole();if(2==(h=this.slen)){this.chk||(d=this.vwr.getStateInfo());break}if(null!=e&&3==this.slen){this.chk||(d=this.vwr.getStateInfo());break}else if(1228935687==this.tokAt(2)&&4==(h=this.slen)){this.chk||(d=this.vwr.fm.getEmbeddedFileState(this.paramAsStr(3),!0));break}h=3;g=
this.paramAsStr(2);this.chk||(d=this.vwr.stm.getSavedState(g));break;case 1639976963:if(2==(h=this.slen)){this.chk||(d=this.vwr.ms.getProteinStructureState(this.vwr.bsA(),134222350));break}g=this.paramAsStr(2);this.chk||(d=this.vwr.stm.getSavedStructure(g));break;case 134221834:g=3==(h=this.slen)?this.paramAsStr(2):null;this.chk||(d=this.vwr.getDataObj(g,null,-2),d=null==d?"no data":JU.Escape.encapsulateData(d[0],d[1],d[3].intValue()));break;case 1073742330:h=3;d=a.setObjectProperty();break;case 1678381065:this.chk||
(d=this.vwr.ms.getBoundBoxCommand(!0));break;case 12289:this.chk||(d="center "+JU.Escape.eP(this.vwr.tm.fixedRotationCenter));break;case 135176:this.chk||(d=this.getShapeProperty(22,"command"));break;case 1228935687:if(2==this.slen){this.chk||(null==e&&this.vwr.sm.clearConsole(),d=this.vwr.getCurrentFileAsString("script"));null==d&&(d="<unavailable>");break}h=3;c=this.paramAsStr(2);this.chk||(null==e&&this.vwr.sm.clearConsole(),d=this.vwr.getFileAsString3(c,!0,null));break;case 4115:d=1073742327==
this.tokAt(2)&&0<(h=3)?this.vwr.getModelFileInfoAll():this.vwr.getModelFileInfo();break;case 1610616855:g=2==(h=this.slen)?2147483647:this.intParameter(2);1>g&&this.invArg();this.chk||(this.vwr.sm.clearConsole(),0==a.scriptLevel&&this.vwr.removeCommand(),d=this.vwr.getSetHistory(g));break;case 135180:this.chk||(d=this.getShapeProperty(24,"jvxlDataXml"));break;case 1073877011:case 1073877010:a.optParameterAsString(2).equalsIgnoreCase("list")?(this.e.sm.loadShape(27),d=this.chk?"":this.getShapeProperty(27,
"list -1"),h=3):(j=2==(h=this.slen)?-2147483648:this.intParameter(2),this.chk||(d=this.getMoJvxl(j,1073877011==g)));break;case 1094717454:this.chk||(d=this.vwr.ms.getModelInfoAsString());break;case 537006096:this.chk||(d=this.vwr.getMeasurementInfoAsString());break;case 1073741863:h=3;!this.chk&&this.slen==h&&(d=this.vwr.getOrientationText(this.tokAt(2),null));break;case 1073742132:g=this.tokAt(2),0==g?g=1073742132:h=3;case 1073742178:case 4129:this.chk||(d=this.vwr.getOrientationText(g,null));break;
case 1073742077:h=2;if(3<this.slen)break;switch(g=this.tokAt(2)){case 1073742178:case 1073742132:case 4129:case 0:this.chk||(d=this.vwr.getOrientationText(g,null));break;default:g=a.optParameterAsString(2),d=this.vwr.getOrientationText(1073742035,g)}h=this.slen;break;case 1073742088:this.chk||(d=this.vwr.ms.getPDBHeader(this.vwr.am.cmi));break;case 134217762:g=a.optParameterAsString(2);0==g.length&&(g=null);h=this.slen;this.chk||(d=this.vwr.ms.getPointGroupAsString(this.vwr.bsA(),"show:"+g,0,0,null,
null,null));break;case 1088421903:this.chk||(d=this.vwr.ms.getSymmetryInfoAsString());break;case 1073742176:this.chk||(d="transform:\n"+this.vwr.tm.matrixRotate.toString());break;case 4168:d="zoom "+(this.vwr.tm.zoomEnabled?""+this.vwr.tm.getZoomSetting():"off");break;case 1611272202:d=this.vwr.getShowFrank()?"frank ON":"frank OFF";break;case 1665140738:b="solventProbeRadius";break;case 1086324744:if(3==(h=this.slen)&&1073742334==this.tokAt(2))g=1086324743;case 1073741864:case 1086324740:case 1073742120:case 1113589787:case 1086324742:case 1140850689:case 1073741982:this.chk||
(d=this.vwr.getChimeInfo(g));break;case 537022465:case 1610612738:case 20482:case 1612709912:c="?";break;case 1073742031:g=2==(h=this.slen)?null:this.paramAsStr(2);this.chk||(d=this.vwr.getBindingInfo(g));break;case 1073742015:this.chk||(c=this.vwr.getMenu(""));break;case 1073741824:b.equalsIgnoreCase("fileHeader")&&(this.chk||(d=this.vwr.ms.getPDBHeader(this.vwr.am.cmi)));break;case 1073741992:case 36868:b=this.paramAsStr(h++),j=a.getParameter(b,1073742190,!0),this.chk||(d=1073741992==g?j.toJSON():
j.escape())}this.checkLength(h+f);this.chk||(null!=d?this.showString(this.filterShow(d,e)):null!=c?this.showString(b+" = "+c):null!=b&&(0<=b.indexOf(" ")?this.showString(b):this.showString(b+" = "+a.getParameter(b,1073742190,!0).escape())))});l(c$,"filterShow",function(a,c){if(null==c)return a;c=c.substring(1).toLowerCase();for(var b=JU.PT.split(a,"\n"),e=new JU.SB,f=0;f<b.length;f++)0<=b[f].toLowerCase().indexOf(c)&&e.append(b[f]).appendC("\n");return e.toString()},"~S,~S");l(c$,"stereo",function(){for(var a=
J.c.STER.DOUBLE,c=-5,b=!1,e=null,f=0,d=1;d<this.slen;++d)if(this.e.isColorParam(d))1<f&&this.e.bad(),0==f&&(e=E(2,0)),b||(c=3),e[f]=this.e.getArgbParam(d),0==f++&&(e[1]=~e[0]),d=this.e.iToken;else switch(this.getToken(d).tok){case 1073742335:this.e.checkLast(this.e.iToken=1);this.e.iToken=1;break;case 1073742334:this.e.checkLast(this.e.iToken=1);a=J.c.STER.NONE;break;case 2:case 3:c=this.floatParameter(d);b=!0;break;case 1073741824:if(b||(c=3),a=J.c.STER.getStereoMode(this.paramAsStr(d)),null!=a)break;
default:this.invArg()}this.chk||this.vwr.setStereoMode(e,a,c)});l(c$,"struts",function(){var a=this.e,c=1073742072==this.tokAt(1)||1073742335==this.tokAt(1)||1==this.slen,b=a.getMadParameter();if(2147483647==b)return!1;c&&(b=Math.round(2E3*this.vwr.getFloat(570425406)));this.setShapeProperty(1,"type",Integer.$valueOf(32768));a.setShapeSizeBs(1,b,null);this.setShapeProperty(1,"type",Integer.$valueOf(1023));return!0});l(c$,"unitcell",function(a){var c=this.e,b=2147483647,e=2147483647,f=null,d=c.tickParamAsStr(a,
!0,!1,!1);a=c.iToken;var g=null,h=null,j=null,l=null,m=e=!1;switch(this.tokAt(++a)){case 4142:case 4141:m=!0;f=JU.P4.new4(0,0,0,-1);c.iToken++;break;case 4:case 1073741824:var k=this.paramAsStr(a).toLowerCase(),l=k;if(0>k.indexOf(",")&&!this.chk){c.setCurrentCagePts(null,null);JU.PT.isOneOf(l,";parent;standard;primitive;")&&(j=this.vwr.ms.getInfo(this.vwr.am.cmi,"unitcell_conventional"),null!=j&&c.setCurrentCagePts(this.vwr.getV0abc(j),""+j));k=this.vwr.ms.getInfo(this.vwr.am.cmi,"unitcell_"+l);if(null==
k&&((e=l.equals("primitive"))||l.equals("reciprocal"))){k=this.vwr.getCurrentUnitCell();l=(null==k?"":k.getSpaceGroupName()+" ")+l;h=null==k?z(-1,[JU.P3.new3(0,0,0),JU.P3.new3(1,0,0),JU.P3.new3(0,1,0),JU.P3.new3(0,0,1)]):k.getUnitCellVectors();e?(e=this.vwr.getSymTemp().getSymmetryInfoAtom(this.vwr.ms,this.vwr.getFrameAtoms().nextSetBit(0),null,0,null,null,null,1073741994,0,-1),(null==k?this.vwr.getSymTemp():k).toFromPrimitive(!0,e.charAt(0),h)):JU.SimpleUnitCell.getReciprocal(h,h);break}this.showString(k)}j=
k;break;case 135180:case 1073742330:g=c.objectNameParameter(++a);break;case 1678381065:h=JU.P3.newP(this.vwr.getBoundBoxCenter());f=this.vwr.getBoundBoxCornerVector();h.sub(f);h=z(-1,[h,JU.P3.new3(2*f.x,0,0),JU.P3.new3(0,2*f.y,0),JU.P3.new3(0,0,2*f.z)]);f=null;c.iToken=a;break;case 1073742176:12!=this.tokAt(++a)&&this.invArg();j=z(-1,[this.getToken(a).value]);break;case 11:case 12:j=this.getToken(a).value;break;case 12289:switch(this.tokAt(++a)){case 10:case 1073742325:f=this.vwr.ms.getAtomSetCenter(this.atomExpressionAt(a));
this.vwr.toFractional(f,!0);a=c.iToken;break;default:if(c.isCenterParameter(a)){f=this.centerParameter(a);a=c.iToken;break}this.invArg()}f.x-=0.5;f.y-=0.5;f.z-=0.5;break;case 10:case 1073742325:a=this.atomExpressionAt(a).nextSetBit(0);this.chk||(this.vwr.am.cai=a);if(0>a)return;a=c.iToken;break;case 1073742066:e=!0;case 1073742114:f=c.getPointOrPlane(++a,!1,!0,!1,!0,3,3);f=JU.P4.new4(f.x,f.y,f.z,e?1:0);a=c.iToken;break;case 3:case 2:if(111>this.floatParameter(a)){a--;break}b=this.intParameter(a);
break;default:c.isArrayParameter(a)?(h=c.getPointArray(a,4,!1),a=c.iToken):this.slen>a+1?(f=c.getPointOrPlane(a,!1,!0,!1,!0,3,3),a=c.iToken):a--}e=c.getSetAxesTypeMad10(++a);c.checkLast(c.iToken);this.chk||2147483647==e||(2147483647==e&&(this.vwr.am.cai=-1),null==h&&null!=j&&(h=this.vwr.getV0abc(j)),2147483647!=b?this.vwr.ms.setUnitCellOffset(this.vwr.getCurrentUnitCell(),null,b):null!=g?this.vwr.setCurrentCage(g):(m||null!=h)&&c.setCurrentCagePts(h,l),c.setObjectMad10(33,"unitCell",e),null!=f&&this.vwr.ms.setUnitCellOffset(this.vwr.getCurrentUnitCell(),
f,0),null!=d&&this.setShapeProperty(33,"tickInfo",d))},"~N");l(c$,"assign",function(){var a=this.tokAt(1),c=this.atomExpressionAt(2).nextSetBit(0),b=-1,e=null;if(!(0>c)){4106==a?b=this.atomExpressionAt(++this.e.iToken).nextSetBit(0):e=this.paramAsStr(++this.e.iToken);var f=++this.e.iToken<this.slen?this.centerParameter(this.e.iToken):null;if(!this.chk)switch(a){case 1140850689:this.e.clearDefinedVariableAtomSets();this.assignAtom(c,f,e);break;case 1677721602:this.assignBond(c,(e+"p").charAt(0));break;
case 4106:this.assignConnect(c,b)}}});l(c$,"assignAtom",function(a,c,b){b.equals("X")&&this.vwr.setRotateBondIndex(-1);if(this.vwr.ms.at[a].mi==this.vwr.ms.mc-1){this.vwr.clearModelDependentObjects();var e=this.vwr.ms.ac;if(null==c)this.vwr.sm.modifySend(a,this.vwr.ms.at[a].mi,1,this.e.fullCommand),this.vwr.ms.assignAtom(a,b,!0),JU.PT.isOneOf(b,";Mi;Pl;X;")||this.vwr.ms.setAtomNamesAndNumbers(a,-e,null),this.vwr.sm.modifySend(a,this.vwr.ms.at[a].mi,-1,"OK"),this.vwr.refresh(3,"assignAtom");else{var f=
this.vwr.ms.at[a],d=JU.BSUtil.newAndSetBit(a);c=z(-1,[c]);var g=new JU.Lst;g.addLast(f);f=f.mi;this.vwr.sm.modifySend(a,f,3,this.e.fullCommand);try{d=this.vwr.addHydrogensInline(d,g,c),a=d.nextSetBit(0),this.vwr.ms.assignAtom(a,b,!1)}catch(h){if(!M(h,Exception))throw h;}this.vwr.ms.setAtomNamesAndNumbers(a,-e,null);this.vwr.sm.modifySend(a,f,-3,"OK")}}},"~N,JU.P3,~S");l(c$,"assignBond",function(a,c){var b=-1;try{b=this.vwr.ms.bo[a].atom1.mi;this.vwr.sm.modifySend(a,b,2,this.e.fullCommand);var e=this.vwr.ms.setBondOrder(a,
c);null==e||"0"==c?this.vwr.refresh(3,"setBondOrder"):this.vwr.addHydrogens(e,!1,!0);this.vwr.sm.modifySend(a,b,-2,""+c)}catch(f){if(M(f,Exception))JU.Logger.error("assignBond failed"),this.vwr.sm.modifySend(a,b,-2,"ERROR "+f);else throw f;}},"~N,~S");l(c$,"assignConnect",function(a,c){this.vwr.clearModelDependentObjects();var b=JU.AU.newFloat2(1);b[0]=L(-1,[a,c]);var e=this.vwr.ms.at[a].mi;this.vwr.sm.modifySend(a,e,2,this.e.fullCommand);this.vwr.ms.connect(b);this.vwr.ms.assignAtom(a,".",!0);this.vwr.ms.assignAtom(c,
".",!0);this.vwr.sm.modifySend(a,e,-2,"OK");this.vwr.refresh(3,"assignConnect")},"~N,~N");l(c$,"getContext",function(a){for(var c=new JU.SB,b=this.e.thisContext;null!=b;)a?null!=b.vars&&(c.append(this.getScriptID(b)),c.append(JV.StateManager.getVariableList(b.vars,80,!0,!1))):c.append(JS.ScriptError.getErrorLineMessage(b.functionName,b.scriptFileName,this.e.getLinenumber(b),b.pc,JS.ScriptEval.statementAsString(this.vwr,b.statement,-9999,this.e.debugHigh))),b=b.parentContext;a?null!=this.e.contextVariables&&
(c.append(this.getScriptID(null)),c.append(JV.StateManager.getVariableList(this.e.contextVariables,80,!0,!1))):c.append(this.e.getErrorLineMessage2());return c.toString()},"~B");l(c$,"getIsosurfaceJvxl",function(a,c){return this.chk?"":this.getShapeProperty(c,a?"jvxlMeshX":"jvxlDataXml")},"~B,~N");l(c$,"getMoJvxl",function(a,c){var b=c?28:27;this.e.sm.loadShape(b);var e=this.vwr.am.cmi;0>e&&this.e.errorStr(30,"show/write MO/NBO");var f=this.vwr.ms.getInfo(e,"moData");null==f&&this.error(27);var d=
this.getShapeProperty(b,"moNumber");(null==d||0==d.intValue())&&this.setShapeProperty(b,"init",Integer.$valueOf(e));this.setShapeProperty(b,"moData",f);return this.getShapePropertyIndex(b,"showMO",a)},"~N,~B");l(c$,"getScriptID",function(a){return"\n# "+(null==a?this.e.functionName:"function "+a.functionName)+" (file "+(null==a?this.e.scriptFileName:a.scriptFileName)+(null==a?"":" context "+a.id)+")\n"},"JS.ScriptContext");l(c$,"getShapePropertyIndex",function(a,c,b){return this.e.sm.getShapePropertyIndex(a,
c,b)},"~N,~S,~N");l(c$,"tokenAt",function(a,c){return a<c.length?c[a]:null},"~N,~A");c$.tokAtArray=l(c$,"tokAtArray",function(a,c){return a<c.length&&null!=c[a]?c[a].tok:0},"~N,~A");l(c$,"getPlotMinMax",function(a,c,b){if(null==a)return 0;switch(b){case 1111490568:case 1111490569:case 1111490570:return c?180:-180;case 1111490565:case 1111490576:return c?360:0;case 1111490574:return c?1:-1}b=c?-1E10:1E10;for(var e=a.length;0<=--e;){var f=a[e];Float.isNaN(f)||c==f>b&&(b=f)}return b},"~A,~B,~N");l(c$,
"parseDataArray",function(a,c){a=JU.Parser.fixDataString(a);var b=JU.Parser.markLines(a,"\n"),e=b.length;if(!c){for(var f=JU.AU.newFloat2(e),d=0,g=0;d<e;g=b[d++])g=JU.PT.getTokens(a.substring(g,b[d])),JU.PT.parseFloatArrayData(g,f[d]=L(g.length,0));return f}g=JU.PT.getTokens(a.substring(0,b[0]));if(3!=g.length)return L(0,0,0,0);var h=JU.PT.parseInt(g[0]),j=JU.PT.parseInt(g[1]),l=JU.PT.parseInt(g[2]);if(1>h||1>j||1>l)return L(1,1,1,0);for(var f=JU.AU.newFloat3(h,j),m=0,k=0,d=1,g=b[0];d<e&&m<h;g=b[d++])g=
JU.PT.getTokens(a.substring(g,b[d])),g.length<l||(JU.PT.parseFloatArrayData(g,f[m][k]=L(g.length,0)),++k==j&&(m++,k=0));return m!=h?(System.out.println("Error reading 3D data -- nX = "+h+", but only "+m+" blocks read"),L(1,1,1,0)):f},"~S,~B");l(c$,"getBitsetPropertyFloat",function(a,c,b,e,f){c=null==b?this.e.getBitsetProperty(a,c,null,null,null,null,!1,2147483647,!1):this.vwr.getDataObj(b,a,1);if(null==c||!JU.AU.isAF(c))return L(a.cardinality(),0);if(!Float.isNaN(e))for(a=0;a<c.length;a++)c[a]<e&&
(c[a]=NaN);if(!Float.isNaN(f))for(a=0;a<c.length;a++)c[a]>f&&(c[a]=NaN);return c},"JU.BS,~N,~S,~N,~N");U(c$,"ERROR_invalidArgument",22)})})(Clazz,Clazz.newLongArray,Clazz.doubleToByte,Clazz.doubleToInt,Clazz.doubleToLong,Clazz.declarePackage,Clazz.instanceOf,Clazz.load,Clazz.instantialize,Clazz.decorateAsClass,Clazz.floatToInt,Clazz.floatToLong,Clazz.makeConstructor,Clazz.defineEnumConstant,Clazz.exceptionOf,Clazz.newIntArray,Clazz.defineStatics,Clazz.newFloatArray,Clazz.declareType,Clazz.prepareFields,
Clazz.superConstructor,Clazz.newByteArray,Clazz.declareInterface,Clazz.p0p,Clazz.pu$h,Clazz.newShortArray,Clazz.innerTypeInstance,Clazz.isClassDefined,Clazz.prepareCallback,Clazz.newArray,Clazz.castNullAs,Clazz.floatToShort,Clazz.superCall,Clazz.decorateAsType,Clazz.newBooleanArray,Clazz.newCharArray,Clazz.implementOf,Clazz.newDoubleArray,Clazz.overrideConstructor,Clazz.clone,Clazz.doubleToShort,Clazz.getInheritedLevel,Clazz.getParamsType,Clazz.isAF,Clazz.isAB,Clazz.isAI,Clazz.isAS,Clazz.isASS,Clazz.isAP,
Clazz.isAFloat,Clazz.isAII,Clazz.isAFF,Clazz.isAFFF,Clazz.tryToSearchAndExecute,Clazz.getStackTrace,Clazz.inheritArgs,Clazz.alert,Clazz.defineMethod,Clazz.overrideMethod,Clazz.declareAnonymous,Clazz.cloneFinals);
